<!DOCTYPE html><html><head><title>Лекция 5 Apache HIVE Pig (раздатка).docx</title><link rel="shortcut icon" href="https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=0"><meta name="referrer" content="strict-origin-when-cross-origin"><style nonce="mTbTQv287tnXSu8VbpmL7g">
html {
  overflow: auto;
}
body {
  margin: 0;
  overflow: hidden;
  word-wrap: break-word;
}
.app-container {
  height: 100%;
  /* Height of mobileweb header + 1 px vertical shadow. */
  margin-top: 57px;
  overflow: auto;
}
.doc {
  padding: 20px 12px 0 12px;
  position: relative;
}
.doc .doc-content {
  margin: auto;
  /* Override the inline style that is set on the .doc-content div, which is used to store layout
     data for roundtripping. */
  padding: 24px 0 !important;
  max-width: 770px !important;
}
</style><style>@import url(https://fonts.googleapis.com/css?family=Google+Sans);.docs-ml-noselect{-webkit-touch-callout:none;-webkit-user-drag:none;-webkit-user-select:none;user-select:none}.docs-ml-promotion{z-index:1002}.docs-ml-header{z-index:1}.docs-ml-icon{direction:ltr;display:inline-block;text-align:left;overflow:hidden;position:relative;vertical-align:middle}.docs-ml-img:before{content:url(//ssl.gstatic.com/docs/common/mobileweb_sprite1.png)}.docs-ml-img-container{height:156px;position:absolute;width:36px}.docs-ml-docs-logo-icon{left:0;top:-36px}.docs-ml-sheets-logo-icon{left:0;top:0}.docs-ml-slides-logo-icon{left:0;top:-96px}.docs-ml-arrow-back-icon{left:0;top:-132px}.docs-ml-edit-icon{left:0;top:-72px}@media screen and (-webkit-min-device-pixel-ratio:2){.docs-ml-img{content:url(//ssl.gstatic.com/docs/common/mobileweb_sprite1.png)}.docs-ml-img-container{height:156px;position:absolute;width:36px}.docs-ml-docs-logo-icon{left:0;top:-36px}.docs-ml-sheets-logo-icon{left:0;top:0}.docs-ml-slides-logo-icon{left:0;top:-96px}.docs-ml-arrow-back-icon{left:0;top:-132px}.docs-ml-edit-icon{left:0;top:-72px}}.docs-ml-header{background:#fafafa;border-bottom:1px solid #cbcbcb;box-shadow:0 1px 1px rgba(0,0,0,.1);box-sizing:border-box;font-family:Google Sans,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;padding:4px 0;position:fixed;left:0;top:0;width:100%}.docs-ml-header-icon{height:24px;opacity:.6;width:24px}.docs-ml-header-icon-container{padding:12px}.docs-ml-header-item{display:inline-block;vertical-align:middle}.docs-ml-header-drive-link{padding-left:4px}body[dir=rtl] .docs-ml-arrow-back-dir{transform:scaleX(-1)}.docs-ml-header-document-title{box-sizing:border-box;line-height:24px;padding:0 12px;width:60%;width:calc(100% - 104px)}.docs-ml-header-document-title-text{font-size:20px;font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.docs-ml-header-edit-button{float:right;padding-right:4px}.docs-ml-promotion{background:#fff;bottom:0;box-shadow:0 4px 12px rgba(0,0,0,.4);font-family:Arial,Helvetica,sans-serif;left:0;position:fixed;width:100%}.docs-ml-promotion-off-screen{transform:translateY(100%)}.docs-ml-promotion-shown{transform:translateY(0);transition:transform 333ms cubic-bezier(.4,0,.2,1)}.docs-ml-promotion-dismissed{transform:translateY(100%);box-shadow:none}.docs-ml-promotion-no-horizontal-scroll{overflow-x:hidden}.docs-ml-promotion-header{display:table;padding:24px 24px 0 24px}.docs-ml-promotion-app-icon-container{display:table-cell}.docs-ml-promotion-app-icon{height:36px;width:36px}@media (min-width:600px){.docs-ml-promotion-app-icon{transform:scale(1.33)}}.docs-ml-promotion-text{display:table-cell;padding-left:20px;vertical-align:top}.docs-ml-promotion-text-heading{color:rgba(0,0,0,.87);font-size:16px;font-weight:700;padding-bottom:7px}.docs-ml-promotion-text-body{color:rgba(0,0,0,.87);font-size:14px}.docs-ml-promotion-action-row{float:right;margin-top:6px;padding:8px 24px}.docs-ml-promotion-action-row-desktop{margin-top:6px}.docs-ml-promotion-action-container{display:inline-block;height:48px;margin:6px 4px;vertical-align:middle}.docs-ml-promotion-action-button{display:inline-block;font-size:14px;font-weight:500;padding:9px 12px;vertical-align:middle}.docs-ml-promotion-action-button-wrapper:focus{outline-color:#d6d6d6}.docs-ml-promotion-action-button.docs-ml-promotion-yes-button{background-color:#4285f4;border-radius:4px;color:#fafafa;border:1px solid transparent}.docs-ml-promotion-action-button.docs-ml-promotion-yes-button:active{background-color:#1967d2}.docs-ml-promotion-action-button.docs-ml-promotion-no-button{background-color:#fafafa;color:#5f6368;border-radius:4px;border:1px solid #dadce0}.docs-ml-promotion-action-button.docs-ml-promotion-no-button:active{background-color:#f5f5f5}.docs-ml-promotion.desktop{text-align:center}@media (orientation:portrait){.docs-ml-promotion.desktop{padding-top:56px;padding-bottom:80px}}@media (orientation:landscape){.docs-ml-promotion.desktop{padding-top:36px;padding-bottom:56px}}.docs-ml-promotion-heading-desktop{font-family:Google Sans;font-size:18px;font-weight:700;color:#202124;padding-top:18px;padding-bottom:10px;line-height:1.5;max-width:360px;margin:0 auto}@media (orientation:landscape){.docs-ml-promotion-heading-desktop{padding-top:0;max-width:none}}.docs-ml-promotion-text-body-desktop{font-size:14px;line-height:1.5;color:#5f6368;padding-bottom:10px}.docs-icon.docs-ml-promotion-desktop-icon{height:40px;width:40px;transform:scale(2.5);transform-origin:top}.docs-icon-ml-promotion-icon-container-desktop{height:100px;width:100px;margin-left:auto;margin-right:auto}@media (orientation:landscape){.docs-icon-ml-promotion-icon-container-desktop{display:inline-block;vertical-align:top}.docs-ml-promotion-description-desktop{display:inline-block;vertical-align:top;text-align:left;padding-left:39px;max-width:645px}}@media (orientation:landscape){.docs-ml-promotion-action-row-desktop{margin-left:-8px}}.docs-ml-promotion-action-row-desktop .docs-ml-promotion-action-container{margin:6px 8px;font-family:Google Sans}.docs-ml-promotion-action-row-desktop .docs-ml-promotion-action-button-wrapper:focus{outline:none}.docs-ml-promotion-action-button.docs-ml-promotion-yes-button.docs-ml-promotion-app-themed{background-image:none;border:1px solid transparent!important;border-radius:4px;box-shadow:none;box-sizing:border-box;font-family:Google Sans,Roboto,RobotoDraft,Helvetica,Arial,sans-serif;font-weight:500;font-size:14px;height:36px;letter-spacing:.25px;line-height:16px;padding:9px 24px 11px 24px;background:#1a73e8;color:#fff}.docs-ml-promotion-action-button.docs-ml-promotion-yes-button.docs-ml-promotion-app-themed:active{background-image:none;border:1px solid transparent!important;border-radius:4px;box-shadow:none;box-sizing:border-box;font-family:Google Sans,Roboto,RobotoDraft,Helvetica,Arial,sans-serif;font-weight:500;font-size:14px;height:36px;letter-spacing:.25px;line-height:16px;padding:9px 24px 11px 24px;background:#1a73e8;color:#fff}.docs-ml-promotion-action-button.docs-ml-promotion-no-button.docs-ml-promotion-app-themed{border:1px solid transparent!important;border-radius:4px;box-shadow:none;box-sizing:border-box;font-family:Google Sans,Roboto,RobotoDraft,Helvetica,Arial,sans-serif;font-weight:500;font-size:14px;height:36px;letter-spacing:.25px;line-height:16px;padding:9px 24px 11px 24px;background:#fff;border:1px solid #dadce0!important;color:#1a73e8}.docs-ml-promotion-action-button-wrapper:focus .docs-ml-promotion-action-button.docs-ml-promotion-yes-button.docs-ml-promotion-app-themed{background-image:none;border:1px solid transparent!important;border-radius:4px;box-shadow:none;box-sizing:border-box;font-family:Google Sans,Roboto,RobotoDraft,Helvetica,Arial,sans-serif;font-weight:500;font-size:14px;height:36px;letter-spacing:.25px;line-height:16px;padding:9px 24px 11px 24px;background:#1a73e8;color:#fff;background:#5094ed;box-shadow:0 1px 3px 1px rgba(66,133,244,.15)}.docs-ml-promotion-action-button-wrapper:focus .docs-ml-promotion-action-button.docs-ml-promotion-no-button.docs-ml-promotion-app-themed{border:1px solid transparent!important;border-radius:4px;box-shadow:none;box-sizing:border-box;font-family:Google Sans,Roboto,RobotoDraft,Helvetica,Arial,sans-serif;font-weight:500;font-size:14px;height:36px;letter-spacing:.25px;line-height:16px;padding:9px 24px 11px 24px;background:#e9f1fe;border:1px solid #c1d8fb!important}
/*# sourceMappingURL=mobileweb_css_ltr.css.map */</style><script nonce="mq37_bhmd0cv-1tKTliK5A">_docs_flag_initialData={"docs-daflia":true,"docs-cclt":56,"docs-mwid":false,"docs-smheo":false,"info_params":{"token":"AC4w5VjAf6tD_pzgoQJx2cW8bJmjrVsU8w:1679922045531","includes_info_params":true},"docs-emwc":true,"docs-ecci":true,"ilcm":{"eui":"ADFN-cuu00S33boCphL3H1JAT-GEoPLyEkdFEqqItYC7x7nC32gSHutET4xkOyigLcvH0ZDtNs0v","je":1,"sstu":1679922045893526,"si":"CJT3rqaV_P0CFeFn3gYdajsOog","gsc":5,"ei":[5700019,5700032,5700057,5700103,5700114,5700333,5700611,5700884,5700893,5701034,5702785,5703182,5703307,5703757,5703839,5704572,5704621,5704883,5704905,5705100,5705793,5705891,5706209,5706270,5706523,5706786,5707047,5707075,5707204,5707326,5707361,5707711,5707820,5708365,5708570,5708886,5709085,5709476,5709673,5710587,5710692,5711391,5711495,5712189,5712635,5712909,5712913,5713064,5713195,5713554,5713592,5714310,5715270,5715350,5715728,5716198,5717567,5722046,5723473,5724217,5725855,5726697,5727259,5727701,5728751,5730227,5730287,5731837,5732343,5733770,5734842,5735136,5735254,5735672,5735808,5736126,5736886,5737256,5737802,5739780,5740188,5740343,5740816,5741716,5742158,5742484,5742654,5743146,5743789,5744010,5744290,5744310,5744350,5745660,5745680,5746140,5746650,5746726,5747128,5747218,5747943,5748171,5748993,5750112,5751159,5752371,5752463,5752676,5752716,5753683,5753944,5754027,5754291,5754369,5754389,5754409,5755411,5756276,5756677,5757324,5757344,5757623,5757643,5757665,5758029,5758676,5759209,5759280,5759564,5760169,5760289,5760370,5760452,5760472,5760927,5761273,5762403,5762731,5762771,5763599,5763619,5763700,5763832,5764328,5764468,5764606,5764806,5766374,5767667,5769154,5769481,5770387,5771104,5771124,5772296,5773004,5773916,5773996,5774056,5776034,5776337,5777217,5777651,5779002,5780514,5780652,5780984,5781111,5781337,5782407,5782966,5784556,5785962,5786640,13702623,48966243,49322999,49369466,49372309,49375203,49375882,49378770,49381143,49398670,49421373,49451720,49453026,49454177,49472112,49474048,49487439,49491746,49499310,49499577,49501785,49512334,49518631,49622712,49623242,49624041,49643557,49644064,49649095,49654174,49658623,49700945,49703972,49756767,49769426,49796898,49816066,49822850,49823073,49824184,49833571,49837749,49839660,49842884,49882933,49923428,49924635,49943108,49973360,49979328,50022355,50167020,50179451,50263353,50266111,50273477,50291121,50313283,50319353,50322344,50345203,50349229,50356816,50389219],"crc":0,"cvi":[]},"drive_url":"//drive.google.com/u/1?usp\u003ddocs_web","docs-liap":"/naLogImpressions","docs-sup":"/document/u/1"}; _docs_flag_cek='5q-8jUYSyL0W3KW9ux8-Gw\x3d\x3d'; if (window['DOCS_timing']) {DOCS_timing['ifdld']=new Date().getTime();}</script></head><body><script type="text/javascript" src="/static/document/client/js/945855526-mobileweb_binary_i18n__ru.js" nonce="mq37_bhmd0cv-1tKTliK5A"></script><script type="text/javascript" nonce="mq37_bhmd0cv-1tKTliK5A">if ((!this['DOCS_initDocsMobileWeb']) ||  false ) {if (window.navigator && window.navigator.sendBeacon) {window.navigator.sendBeacon('\/document\/u\/1\/jserror?jobset\x3dprod\x26error\x3dJS+binary+load+failure&context.functionName=DOCS_initDocsMobileWeb' + '&context.serviceWorkerControlled=' + !!(navigator.serviceWorker && navigator.serviceWorker.controller) + '\x26context.actionName\x3dMobileBasic');}(window.enterCoreJsErrorDialog ? enterCoreJsErrorDialog() : (window.location.href = 'https:\/\/support.google.com\/accounts\/answer\/32050'))}DOCS_initDocsMobileWeb( true ,  true , 'Лекция 5 Apache HIVE Pig (раздатка).docx', 'intent:\/\/docs.google.com\/document\/d\/1_iLPALvvlVrt9DQSYXbUeTvoYsfgitG1\/edit#Intent;scheme\x3dhttps;package\x3dcom.google.android.apps.docs.editors.docs;S.browser_fallback_url\x3dmarket:\/\/details?id\x3dcom.google.android.apps.docs.editors.docs;end', 'googledocs:\/\/docs.google.com\/document\/u\/1\/d\/1_iLPALvvlVrt9DQSYXbUeTvoYsfgitG1\/edit',  false );</script><div class="app-container"><div class="doc-container"><div class="doc"><style type="text/css"> ol.lst-kix_list_7-0{list-style-type:none}.lst-kix_list_14-1 > li:before{content:"o  "}.lst-kix_list_14-3 > li:before{content:"▪  "}.lst-kix_list_2-1 > li{counter-increment:lst-ctn-kix_list_2-1}.lst-kix_list_21-8 > li{counter-increment:lst-ctn-kix_list_21-8}.lst-kix_list_14-0 > li:before{content:"●  "}.lst-kix_list_14-4 > li:before{content:"▪  "}ol.lst-kix_list_18-5.start{counter-reset:lst-ctn-kix_list_18-5 0}.lst-kix_list_6-1 > li{counter-increment:lst-ctn-kix_list_6-1}.lst-kix_list_14-5 > li:before{content:"▪  "}.lst-kix_list_14-7 > li:before{content:"▪  "}.lst-kix_list_14-6 > li:before{content:"▪  "}ul.lst-kix_list_9-3{list-style-type:none}ul.lst-kix_list_9-4{list-style-type:none}ul.lst-kix_list_9-1{list-style-type:none}ul.lst-kix_list_9-2{list-style-type:none}ul.lst-kix_list_9-7{list-style-type:none}ol.lst-kix_list_7-4.start{counter-reset:lst-ctn-kix_list_7-4 0}ul.lst-kix_list_9-8{list-style-type:none}ol.lst-kix_list_20-2.start{counter-reset:lst-ctn-kix_list_20-2 0}ul.lst-kix_list_9-5{list-style-type:none}.lst-kix_list_5-0 > li{counter-increment:lst-ctn-kix_list_5-0}ul.lst-kix_list_9-6{list-style-type:none}ol.lst-kix_list_2-3.start{counter-reset:lst-ctn-kix_list_2-3 0}ol.lst-kix_list_7-5{list-style-type:none}ol.lst-kix_list_7-6{list-style-type:none}ol.lst-kix_list_7-7{list-style-type:none}ol.lst-kix_list_7-8{list-style-type:none}ol.lst-kix_list_7-1{list-style-type:none}ol.lst-kix_list_7-2{list-style-type:none}ul.lst-kix_list_9-0{list-style-type:none}ol.lst-kix_list_7-3{list-style-type:none}ol.lst-kix_list_7-4{list-style-type:none}.lst-kix_list_14-2 > li:before{content:"▪  "}ol.lst-kix_list_23-2.start{counter-reset:lst-ctn-kix_list_23-2 0}.lst-kix_list_20-7 > li{counter-increment:lst-ctn-kix_list_20-7}ol.lst-kix_list_5-3.start{counter-reset:lst-ctn-kix_list_5-3 0}ul.lst-kix_list_17-1{list-style-type:none}ul.lst-kix_list_17-0{list-style-type:none}.lst-kix_list_4-3 > li{counter-increment:lst-ctn-kix_list_4-3}ul.lst-kix_list_17-8{list-style-type:none}ul.lst-kix_list_17-7{list-style-type:none}ol.lst-kix_list_21-6.start{counter-reset:lst-ctn-kix_list_21-6 0}ul.lst-kix_list_17-6{list-style-type:none}ul.lst-kix_list_17-5{list-style-type:none}ol.lst-kix_list_3-7.start{counter-reset:lst-ctn-kix_list_3-7 0}ul.lst-kix_list_17-4{list-style-type:none}ul.lst-kix_list_17-3{list-style-type:none}.lst-kix_list_14-8 > li:before{content:"▪  "}ul.lst-kix_list_17-2{list-style-type:none}.lst-kix_list_18-8 > li{counter-increment:lst-ctn-kix_list_18-8}ol.lst-kix_list_8-8.start{counter-reset:lst-ctn-kix_list_8-8 0}.lst-kix_list_3-2 > li{counter-increment:lst-ctn-kix_list_3-2}.lst-kix_list_7-2 > li{counter-increment:lst-ctn-kix_list_7-2}.lst-kix_list_5-0 > li:before{content:"" counter(lst-ctn-kix_list_5-0,decimal) ". "}ol.lst-kix_list_6-0{list-style-type:none}ol.lst-kix_list_6-1{list-style-type:none}ol.lst-kix_list_22-3.start{counter-reset:lst-ctn-kix_list_22-3 0}.lst-kix_list_5-4 > li{counter-increment:lst-ctn-kix_list_5-4}.lst-kix_list_1-4 > li{counter-increment:lst-ctn-kix_list_1-4}ol.lst-kix_list_1-6.start{counter-reset:lst-ctn-kix_list_1-6 0}.lst-kix_list_5-3 > li:before{content:"" counter(lst-ctn-kix_list_5-3,decimal) ". "}.lst-kix_list_5-2 > li:before{content:"" counter(lst-ctn-kix_list_5-2,decimal) ". "}.lst-kix_list_8-3 > li{counter-increment:lst-ctn-kix_list_8-3}.lst-kix_list_5-1 > li:before{content:"" counter(lst-ctn-kix_list_5-1,decimal) ". "}.lst-kix_list_5-7 > li:before{content:"" counter(lst-ctn-kix_list_5-7,decimal) ". "}ol.lst-kix_list_20-7.start{counter-reset:lst-ctn-kix_list_20-7 0}.lst-kix_list_5-6 > li:before{content:"" counter(lst-ctn-kix_list_5-6,decimal) ". "}.lst-kix_list_5-8 > li:before{content:"" counter(lst-ctn-kix_list_5-8,decimal) ". "}ol.lst-kix_list_6-6{list-style-type:none}ol.lst-kix_list_6-7{list-style-type:none}.lst-kix_list_5-4 > li:before{content:"" counter(lst-ctn-kix_list_5-4,decimal) ". "}ol.lst-kix_list_6-8{list-style-type:none}.lst-kix_list_5-5 > li:before{content:"" counter(lst-ctn-kix_list_5-5,decimal) ". "}ol.lst-kix_list_6-2{list-style-type:none}ol.lst-kix_list_6-3{list-style-type:none}ol.lst-kix_list_6-4{list-style-type:none}ol.lst-kix_list_6-5{list-style-type:none}.lst-kix_list_23-6 > li:before{content:"" counter(lst-ctn-kix_list_23-6,decimal) ". "}.lst-kix_list_6-1 > li:before{content:"" counter(lst-ctn-kix_list_6-1,decimal) ". "}.lst-kix_list_6-3 > li:before{content:"" counter(lst-ctn-kix_list_6-3,decimal) ". "}.lst-kix_list_6-5 > li{counter-increment:lst-ctn-kix_list_6-5}.lst-kix_list_6-8 > li{counter-increment:lst-ctn-kix_list_6-8}.lst-kix_list_23-3 > li:before{content:"" counter(lst-ctn-kix_list_23-3,decimal) ". "}.lst-kix_list_23-7 > li:before{content:"" counter(lst-ctn-kix_list_23-7,decimal) ". "}.lst-kix_list_6-0 > li:before{content:"" counter(lst-ctn-kix_list_6-0,decimal) ". "}.lst-kix_list_6-4 > li:before{content:"" counter(lst-ctn-kix_list_6-4,decimal) ". "}.lst-kix_list_23-2 > li:before{content:"" counter(lst-ctn-kix_list_23-2,decimal) ". "}ul.lst-kix_list_16-2{list-style-type:none}ol.lst-kix_list_23-7.start{counter-reset:lst-ctn-kix_list_23-7 0}ul.lst-kix_list_16-1{list-style-type:none}ul.lst-kix_list_16-0{list-style-type:none}.lst-kix_list_23-0 > li:before{content:"●  "}.lst-kix_list_23-8 > li:before{content:"" counter(lst-ctn-kix_list_23-8,decimal) ". "}.lst-kix_list_3-6 > li{counter-increment:lst-ctn-kix_list_3-6}.lst-kix_list_23-1 > li:before{content:"" counter(lst-ctn-kix_list_23-1,decimal) ". "}.lst-kix_list_6-2 > li:before{content:"" counter(lst-ctn-kix_list_6-2,decimal) ". "}ul.lst-kix_list_16-8{list-style-type:none}ul.lst-kix_list_16-7{list-style-type:none}ul.lst-kix_list_16-6{list-style-type:none}.lst-kix_list_2-5 > li{counter-increment:lst-ctn-kix_list_2-5}.lst-kix_list_2-8 > li{counter-increment:lst-ctn-kix_list_2-8}ol.lst-kix_list_3-2.start{counter-reset:lst-ctn-kix_list_3-2 0}ul.lst-kix_list_16-5{list-style-type:none}ul.lst-kix_list_16-4{list-style-type:none}.lst-kix_list_6-8 > li:before{content:"" counter(lst-ctn-kix_list_6-8,decimal) ". "}ul.lst-kix_list_16-3{list-style-type:none}.lst-kix_list_6-5 > li:before{content:"" counter(lst-ctn-kix_list_6-5,decimal) ". "}.lst-kix_list_6-7 > li:before{content:"" counter(lst-ctn-kix_list_6-7,decimal) ". "}.lst-kix_list_23-4 > li:before{content:"" counter(lst-ctn-kix_list_23-4,decimal) ". "}.lst-kix_list_23-5 > li:before{content:"" counter(lst-ctn-kix_list_23-5,decimal) ". "}.lst-kix_list_6-6 > li:before{content:"" counter(lst-ctn-kix_list_6-6,decimal) ". "}.lst-kix_list_7-4 > li:before{content:"" counter(lst-ctn-kix_list_7-4,decimal) ". "}.lst-kix_list_7-6 > li:before{content:"" counter(lst-ctn-kix_list_7-6,decimal) ". "}.lst-kix_list_18-5 > li{counter-increment:lst-ctn-kix_list_18-5}ol.lst-kix_list_19-7.start{counter-reset:lst-ctn-kix_list_19-7 -1}ol.lst-kix_list_6-2.start{counter-reset:lst-ctn-kix_list_6-2 0}.lst-kix_list_22-2 > li:before{content:"" counter(lst-ctn-kix_list_22-2,decimal) ". "}.lst-kix_list_22-6 > li:before{content:"" counter(lst-ctn-kix_list_22-6,decimal) ". "}.lst-kix_list_22-2 > li{counter-increment:lst-ctn-kix_list_22-2}.lst-kix_list_7-2 > li:before{content:"" counter(lst-ctn-kix_list_7-2,decimal) ". "}.lst-kix_list_7-6 > li{counter-increment:lst-ctn-kix_list_7-6}.lst-kix_list_8-6 > li{counter-increment:lst-ctn-kix_list_8-6}.lst-kix_list_22-0 > li:before{content:"●  "}.lst-kix_list_22-8 > li:before{content:"" counter(lst-ctn-kix_list_22-8,decimal) ". "}ol.lst-kix_list_22-8.start{counter-reset:lst-ctn-kix_list_22-8 0}ol.lst-kix_list_4-6.start{counter-reset:lst-ctn-kix_list_4-6 0}ol.lst-kix_list_22-5.start{counter-reset:lst-ctn-kix_list_22-5 0}.lst-kix_list_13-7 > li:before{content:"▪  "}ol.lst-kix_list_3-0.start{counter-reset:lst-ctn-kix_list_3-0 0}.lst-kix_list_5-7 > li{counter-increment:lst-ctn-kix_list_5-7}.lst-kix_list_7-8 > li:before{content:"" counter(lst-ctn-kix_list_7-8,decimal) ". "}.lst-kix_list_4-7 > li{counter-increment:lst-ctn-kix_list_4-7}.lst-kix_list_22-4 > li:before{content:"" counter(lst-ctn-kix_list_22-4,decimal) ". "}ol.lst-kix_list_2-5.start{counter-reset:lst-ctn-kix_list_2-5 0}.lst-kix_list_15-5 > li:before{content:"▪  "}.lst-kix_list_4-1 > li:before{content:"" counter(lst-ctn-kix_list_4-1,decimal) ". "}.lst-kix_list_15-7 > li:before{content:"▪  "}.lst-kix_list_4-3 > li:before{content:"" counter(lst-ctn-kix_list_4-3,decimal) ". "}.lst-kix_list_4-5 > li:before{content:"" counter(lst-ctn-kix_list_4-5,decimal) ". "}.lst-kix_list_1-8 > li{counter-increment:lst-ctn-kix_list_1-8}.lst-kix_list_15-1 > li:before{content:"o  "}ol.lst-kix_list_1-4.start{counter-reset:lst-ctn-kix_list_1-4 0}.lst-kix_list_3-5 > li{counter-increment:lst-ctn-kix_list_3-5}ol.lst-kix_list_1-1.start{counter-reset:lst-ctn-kix_list_1-1 0}ol.lst-kix_list_18-3.start{counter-reset:lst-ctn-kix_list_18-3 0}.lst-kix_list_15-3 > li:before{content:"▪  "}.lst-kix_list_22-1 > li{counter-increment:lst-ctn-kix_list_22-1}ol.lst-kix_list_18-7{list-style-type:none}ol.lst-kix_list_4-4.start{counter-reset:lst-ctn-kix_list_4-4 0}ol.lst-kix_list_18-8{list-style-type:none}ol.lst-kix_list_18-3{list-style-type:none}ol.lst-kix_list_18-4{list-style-type:none}.lst-kix_list_6-4 > li{counter-increment:lst-ctn-kix_list_6-4}ol.lst-kix_list_18-5{list-style-type:none}ol.lst-kix_list_18-6{list-style-type:none}ol.lst-kix_list_18-1{list-style-type:none}ol.lst-kix_list_18-2{list-style-type:none}.lst-kix_list_19-2 > li{counter-increment:lst-ctn-kix_list_19-2}ol.lst-kix_list_2-8.start{counter-reset:lst-ctn-kix_list_2-8 0}ol.lst-kix_list_8-8{list-style-type:none}.lst-kix_list_12-3 > li:before{content:"▪  "}ol.lst-kix_list_7-6.start{counter-reset:lst-ctn-kix_list_7-6 0}ol.lst-kix_list_8-4{list-style-type:none}.lst-kix_list_12-1 > li:before{content:"o  "}ol.lst-kix_list_8-5{list-style-type:none}ol.lst-kix_list_8-6{list-style-type:none}ol.lst-kix_list_8-7{list-style-type:none}ol.lst-kix_list_8-0{list-style-type:none}ol.lst-kix_list_8-1{list-style-type:none}.lst-kix_list_23-6 > li{counter-increment:lst-ctn-kix_list_23-6}ol.lst-kix_list_8-2{list-style-type:none}ol.lst-kix_list_8-3{list-style-type:none}.lst-kix_list_21-4 > li{counter-increment:lst-ctn-kix_list_21-4}.lst-kix_list_13-3 > li:before{content:"▪  "}ul.lst-kix_list_18-0{list-style-type:none}ol.lst-kix_list_5-8.start{counter-reset:lst-ctn-kix_list_5-8 0}.lst-kix_list_1-3 > li{counter-increment:lst-ctn-kix_list_1-3}.lst-kix_list_13-5 > li:before{content:"▪  "}.lst-kix_list_12-5 > li:before{content:"▪  "}.lst-kix_list_18-4 > li{counter-increment:lst-ctn-kix_list_18-4}.lst-kix_list_12-7 > li:before{content:"▪  "}ol.lst-kix_list_6-0.start{counter-reset:lst-ctn-kix_list_6-0 0}ol.lst-kix_list_21-1.start{counter-reset:lst-ctn-kix_list_21-1 0}.lst-kix_list_4-2 > li{counter-increment:lst-ctn-kix_list_4-2}.lst-kix_list_13-1 > li:before{content:"o  "}ol.lst-kix_list_3-1{list-style-type:none}ol.lst-kix_list_3-2{list-style-type:none}ol.lst-kix_list_3-3{list-style-type:none}ol.lst-kix_list_3-4.start{counter-reset:lst-ctn-kix_list_3-4 0}.lst-kix_list_5-1 > li{counter-increment:lst-ctn-kix_list_5-1}ol.lst-kix_list_3-4{list-style-type:none}ol.lst-kix_list_19-0.start{counter-reset:lst-ctn-kix_list_19-0 0}.lst-kix_list_22-8 > li{counter-increment:lst-ctn-kix_list_22-8}ol.lst-kix_list_21-3.start{counter-reset:lst-ctn-kix_list_21-3 0}ol.lst-kix_list_3-0{list-style-type:none}.lst-kix_list_1-1 > li{counter-increment:lst-ctn-kix_list_1-1}.lst-kix_list_7-1 > li{counter-increment:lst-ctn-kix_list_7-1}ol.lst-kix_list_2-6.start{counter-reset:lst-ctn-kix_list_2-6 0}.lst-kix_list_3-0 > li:before{content:"" counter(lst-ctn-kix_list_3-0,decimal) ". "}ol.lst-kix_list_20-5.start{counter-reset:lst-ctn-kix_list_20-5 0}.lst-kix_list_21-8 > li:before{content:"" counter(lst-ctn-kix_list_21-8,decimal) ". "}.lst-kix_list_4-0 > li{counter-increment:lst-ctn-kix_list_4-0}.lst-kix_list_8-0 > li{counter-increment:lst-ctn-kix_list_8-0}.lst-kix_list_3-4 > li:before{content:"" counter(lst-ctn-kix_list_3-4,decimal) ". "}ol.lst-kix_list_18-2.start{counter-reset:lst-ctn-kix_list_18-2 0}.lst-kix_list_3-3 > li:before{content:"" counter(lst-ctn-kix_list_3-3,decimal) ". "}ol.lst-kix_list_3-5{list-style-type:none}ol.lst-kix_list_3-6{list-style-type:none}.lst-kix_list_8-0 > li:before{content:"" counter(lst-ctn-kix_list_8-0,decimal) ". "}ol.lst-kix_list_3-7{list-style-type:none}ol.lst-kix_list_3-8{list-style-type:none}.lst-kix_list_8-7 > li:before{content:"" counter(lst-ctn-kix_list_8-7,decimal) ". "}.lst-kix_list_3-8 > li:before{content:"" counter(lst-ctn-kix_list_3-8,decimal) ". "}.lst-kix_list_21-0 > li:before{content:"●  "}.lst-kix_list_21-1 > li:before{content:"" counter(lst-ctn-kix_list_21-1,decimal) ". "}.lst-kix_list_8-3 > li:before{content:"" counter(lst-ctn-kix_list_8-3,decimal) ". "}ul.lst-kix_list_13-5{list-style-type:none}ol.lst-kix_list_22-7{list-style-type:none}ul.lst-kix_list_13-4{list-style-type:none}ol.lst-kix_list_22-6{list-style-type:none}ul.lst-kix_list_13-3{list-style-type:none}ul.lst-kix_list_13-2{list-style-type:none}ol.lst-kix_list_22-8{list-style-type:none}ul.lst-kix_list_13-1{list-style-type:none}.lst-kix_list_3-7 > li:before{content:"" counter(lst-ctn-kix_list_3-7,decimal) ". "}ol.lst-kix_list_22-3{list-style-type:none}ul.lst-kix_list_13-0{list-style-type:none}ol.lst-kix_list_22-2{list-style-type:none}.lst-kix_list_8-4 > li:before{content:"" counter(lst-ctn-kix_list_8-4,decimal) ". "}ol.lst-kix_list_22-5{list-style-type:none}ol.lst-kix_list_22-4{list-style-type:none}.lst-kix_list_19-1 > li{counter-increment:lst-ctn-kix_list_19-1}ol.lst-kix_list_22-1{list-style-type:none}ol.lst-kix_list_8-5.start{counter-reset:lst-ctn-kix_list_8-5 0}ul.lst-kix_list_13-8{list-style-type:none}.lst-kix_list_11-1 > li:before{content:"o  "}ul.lst-kix_list_13-7{list-style-type:none}ul.lst-kix_list_13-6{list-style-type:none}.lst-kix_list_21-5 > li:before{content:"" counter(lst-ctn-kix_list_21-5,decimal) ". "}.lst-kix_list_21-4 > li:before{content:"" counter(lst-ctn-kix_list_21-4,decimal) ". "}.lst-kix_list_11-0 > li:before{content:"●  "}.lst-kix_list_8-8 > li:before{content:"" counter(lst-ctn-kix_list_8-8,decimal) ". "}ol.lst-kix_list_2-2{list-style-type:none}.lst-kix_list_16-8 > li:before{content:"▪  "}ol.lst-kix_list_2-3{list-style-type:none}ul.lst-kix_list_23-0{list-style-type:none}ol.lst-kix_list_2-4{list-style-type:none}.lst-kix_list_16-7 > li:before{content:"▪  "}ol.lst-kix_list_7-2.start{counter-reset:lst-ctn-kix_list_7-2 0}ol.lst-kix_list_2-5{list-style-type:none}ol.lst-kix_list_2-0{list-style-type:none}ol.lst-kix_list_2-1{list-style-type:none}ol.lst-kix_list_19-5.start{counter-reset:lst-ctn-kix_list_19-5 -1}.lst-kix_list_4-8 > li:before{content:"" counter(lst-ctn-kix_list_4-8,decimal) ". "}.lst-kix_list_21-5 > li{counter-increment:lst-ctn-kix_list_21-5}.lst-kix_list_4-7 > li:before{content:"" counter(lst-ctn-kix_list_4-7,decimal) ". "}.lst-kix_list_17-0 > li:before{content:"●  "}.lst-kix_list_16-0 > li:before{content:"●  "}ol.lst-kix_list_4-8.start{counter-reset:lst-ctn-kix_list_4-8 0}.lst-kix_list_8-4 > li{counter-increment:lst-ctn-kix_list_8-4}.lst-kix_list_16-4 > li:before{content:"▪  "}ol.lst-kix_list_3-3.start{counter-reset:lst-ctn-kix_list_3-3 0}.lst-kix_list_16-3 > li:before{content:"▪  "}ol.lst-kix_list_2-6{list-style-type:none}ol.lst-kix_list_2-7{list-style-type:none}ol.lst-kix_list_2-8{list-style-type:none}ol.lst-kix_list_18-1.start{counter-reset:lst-ctn-kix_list_18-1 0}ol.lst-kix_list_7-1.start{counter-reset:lst-ctn-kix_list_7-1 0}ul.lst-kix_list_12-6{list-style-type:none}ol.lst-kix_list_23-6{list-style-type:none}ol.lst-kix_list_8-6.start{counter-reset:lst-ctn-kix_list_8-6 0}ul.lst-kix_list_12-5{list-style-type:none}ol.lst-kix_list_23-5{list-style-type:none}.lst-kix_list_17-7 > li:before{content:"▪  "}ul.lst-kix_list_12-4{list-style-type:none}ol.lst-kix_list_23-8{list-style-type:none}ul.lst-kix_list_12-3{list-style-type:none}ol.lst-kix_list_23-7{list-style-type:none}ul.lst-kix_list_12-2{list-style-type:none}ol.lst-kix_list_23-2{list-style-type:none}ul.lst-kix_list_12-1{list-style-type:none}ol.lst-kix_list_21-4.start{counter-reset:lst-ctn-kix_list_21-4 0}ol.lst-kix_list_23-1{list-style-type:none}.lst-kix_list_17-8 > li:before{content:"▪  "}ul.lst-kix_list_12-0{list-style-type:none}ol.lst-kix_list_23-4{list-style-type:none}ol.lst-kix_list_23-3{list-style-type:none}.lst-kix_list_17-3 > li:before{content:"▪  "}.lst-kix_list_17-4 > li:before{content:"▪  "}ul.lst-kix_list_12-8{list-style-type:none}ol.lst-kix_list_20-6.start{counter-reset:lst-ctn-kix_list_20-6 0}ul.lst-kix_list_12-7{list-style-type:none}ol.lst-kix_list_8-0.start{counter-reset:lst-ctn-kix_list_8-0 0}.lst-kix_list_7-0 > li:before{content:"" counter(lst-ctn-kix_list_7-0,decimal) ". "}.lst-kix_list_2-2 > li{counter-increment:lst-ctn-kix_list_2-2}ol.lst-kix_list_19-6.start{counter-reset:lst-ctn-kix_list_19-6 -1}ol.lst-kix_list_4-7.start{counter-reset:lst-ctn-kix_list_4-7 0}ol.lst-kix_list_5-0{list-style-type:none}.lst-kix_list_3-7 > li{counter-increment:lst-ctn-kix_list_3-7}ol.lst-kix_list_5-1{list-style-type:none}ol.lst-kix_list_5-2{list-style-type:none}.lst-kix_list_22-5 > li:before{content:"" counter(lst-ctn-kix_list_22-5,decimal) ". "}.lst-kix_list_2-4 > li:before{content:"" counter(lst-ctn-kix_list_2-4,decimal) ". "}.lst-kix_list_2-8 > li:before{content:"" counter(lst-ctn-kix_list_2-8,decimal) ". "}.lst-kix_list_21-2 > li{counter-increment:lst-ctn-kix_list_21-2}.lst-kix_list_22-1 > li:before{content:"" counter(lst-ctn-kix_list_22-1,decimal) ". "}.lst-kix_list_20-2 > li{counter-increment:lst-ctn-kix_list_20-2}.lst-kix_list_6-6 > li{counter-increment:lst-ctn-kix_list_6-6}.lst-kix_list_7-3 > li:before{content:"" counter(lst-ctn-kix_list_7-3,decimal) ". "}.lst-kix_list_10-0 > li:before{content:"●  "}.lst-kix_list_23-3 > li{counter-increment:lst-ctn-kix_list_23-3}ol.lst-kix_list_21-7.start{counter-reset:lst-ctn-kix_list_21-7 0}.lst-kix_list_13-8 > li:before{content:"▪  "}.lst-kix_list_18-3 > li:before{content:"" counter(lst-ctn-kix_list_18-3,decimal) ". "}.lst-kix_list_18-7 > li:before{content:"" counter(lst-ctn-kix_list_18-7,decimal) ". "}ol.lst-kix_list_5-7{list-style-type:none}ol.lst-kix_list_5-8{list-style-type:none}.lst-kix_list_18-6 > li{counter-increment:lst-ctn-kix_list_18-6}ol.lst-kix_list_5-3{list-style-type:none}.lst-kix_list_8-7 > li{counter-increment:lst-ctn-kix_list_8-7}.lst-kix_list_19-6 > li{counter-increment:lst-ctn-kix_list_19-6}ol.lst-kix_list_5-4{list-style-type:none}ol.lst-kix_list_3-8.start{counter-reset:lst-ctn-kix_list_3-8 0}ol.lst-kix_list_5-5{list-style-type:none}ol.lst-kix_list_5-6{list-style-type:none}.lst-kix_list_7-7 > li:before{content:"" counter(lst-ctn-kix_list_7-7,decimal) ". "}ol.lst-kix_list_8-1.start{counter-reset:lst-ctn-kix_list_8-1 0}.lst-kix_list_20-4 > li{counter-increment:lst-ctn-kix_list_20-4}.lst-kix_list_15-4 > li:before{content:"▪  "}ol.lst-kix_list_19-1.start{counter-reset:lst-ctn-kix_list_19-1 0}.lst-kix_list_5-8 > li{counter-increment:lst-ctn-kix_list_5-8}.lst-kix_list_10-4 > li:before{content:"▪  "}.lst-kix_list_10-8 > li:before{content:"▪  "}ol.lst-kix_list_20-4.start{counter-reset:lst-ctn-kix_list_20-4 0}.lst-kix_list_4-0 > li:before{content:"" counter(lst-ctn-kix_list_4-0,decimal) ". "}ul.lst-kix_list_15-3{list-style-type:none}ul.lst-kix_list_15-2{list-style-type:none}.lst-kix_list_15-0 > li:before{content:"●  "}ul.lst-kix_list_15-1{list-style-type:none}.lst-kix_list_15-8 > li:before{content:"▪  "}ul.lst-kix_list_15-0{list-style-type:none}ol.lst-kix_list_19-4.start{counter-reset:lst-ctn-kix_list_19-4 -1}.lst-kix_list_4-4 > li:before{content:"" counter(lst-ctn-kix_list_4-4,decimal) ". "}ol.lst-kix_list_2-2.start{counter-reset:lst-ctn-kix_list_2-2 0}ol.lst-kix_list_20-1.start{counter-reset:lst-ctn-kix_list_20-1 0}.lst-kix_list_19-4 > li{counter-increment:lst-ctn-kix_list_19-4}ul.lst-kix_list_15-8{list-style-type:none}ul.lst-kix_list_15-7{list-style-type:none}ul.lst-kix_list_15-6{list-style-type:none}.lst-kix_list_9-3 > li:before{content:"▪  "}ul.lst-kix_list_15-5{list-style-type:none}ul.lst-kix_list_15-4{list-style-type:none}ol.lst-kix_list_7-0.start{counter-reset:lst-ctn-kix_list_7-0 0}ol.lst-kix_list_4-0{list-style-type:none}ol.lst-kix_list_4-1{list-style-type:none}ol.lst-kix_list_4-2{list-style-type:none}ol.lst-kix_list_4-3{list-style-type:none}.lst-kix_list_9-7 > li:before{content:"▪  "}.lst-kix_list_2-4 > li{counter-increment:lst-ctn-kix_list_2-4}ol.lst-kix_list_3-6.start{counter-reset:lst-ctn-kix_list_3-6 0}ol.lst-kix_list_21-8.start{counter-reset:lst-ctn-kix_list_21-8 0}.lst-kix_list_11-4 > li:before{content:"▪  "}.lst-kix_list_22-5 > li{counter-increment:lst-ctn-kix_list_22-5}.lst-kix_list_12-4 > li:before{content:"▪  "}.lst-kix_list_5-3 > li{counter-increment:lst-ctn-kix_list_5-3}.lst-kix_list_20-5 > li:before{content:"" counter(lst-ctn-kix_list_20-5,decimal) ". "}ol.lst-kix_list_4-8{list-style-type:none}.lst-kix_list_7-4 > li{counter-increment:lst-ctn-kix_list_7-4}.lst-kix_list_1-0 > li:before{content:"" counter(lst-ctn-kix_list_1-0,decimal) ". "}ol.lst-kix_list_19-2.start{counter-reset:lst-ctn-kix_list_19-2 -1}.lst-kix_list_20-1 > li:before{content:"" counter(lst-ctn-kix_list_20-1,decimal) ". "}ol.lst-kix_list_4-4{list-style-type:none}.lst-kix_list_11-8 > li:before{content:"▪  "}ol.lst-kix_list_4-5{list-style-type:none}ol.lst-kix_list_2-0.start{counter-reset:lst-ctn-kix_list_2-0 0}ol.lst-kix_list_4-6{list-style-type:none}.lst-kix_list_12-0 > li:before{content:"●  "}ol.lst-kix_list_4-7{list-style-type:none}ol.lst-kix_list_8-4.start{counter-reset:lst-ctn-kix_list_8-4 0}.lst-kix_list_1-4 > li:before{content:"" counter(lst-ctn-kix_list_1-4,decimal) ". "}.lst-kix_list_13-0 > li:before{content:"●  "}ol.lst-kix_list_3-5.start{counter-reset:lst-ctn-kix_list_3-5 0}.lst-kix_list_21-7 > li{counter-increment:lst-ctn-kix_list_21-7}ul.lst-kix_list_14-4{list-style-type:none}ul.lst-kix_list_14-3{list-style-type:none}.lst-kix_list_1-6 > li{counter-increment:lst-ctn-kix_list_1-6}ul.lst-kix_list_14-2{list-style-type:none}.lst-kix_list_13-4 > li:before{content:"▪  "}ul.lst-kix_list_14-1{list-style-type:none}ul.lst-kix_list_14-0{list-style-type:none}ol.lst-kix_list_19-3.start{counter-reset:lst-ctn-kix_list_19-3 -1}ul.lst-kix_list_14-8{list-style-type:none}ul.lst-kix_list_14-7{list-style-type:none}.lst-kix_list_2-0 > li:before{content:"" counter(lst-ctn-kix_list_2-0,decimal) ". "}ol.lst-kix_list_2-1.start{counter-reset:lst-ctn-kix_list_2-1 0}.lst-kix_list_18-1 > li{counter-increment:lst-ctn-kix_list_18-1}ol.lst-kix_list_8-3.start{counter-reset:lst-ctn-kix_list_8-3 0}ul.lst-kix_list_14-6{list-style-type:none}ul.lst-kix_list_14-5{list-style-type:none}.lst-kix_list_4-5 > li{counter-increment:lst-ctn-kix_list_4-5}.lst-kix_list_1-8 > li:before{content:"" counter(lst-ctn-kix_list_1-8,decimal) ". "}.lst-kix_list_12-8 > li:before{content:"▪  "}ol.lst-kix_list_20-3.start{counter-reset:lst-ctn-kix_list_20-3 0}.lst-kix_list_8-2 > li{counter-increment:lst-ctn-kix_list_8-2}.lst-kix_list_4-1 > li{counter-increment:lst-ctn-kix_list_4-1}.lst-kix_list_19-0 > li:before{content:" "}.lst-kix_list_19-1 > li:before{content:" "}.lst-kix_list_23-8 > li{counter-increment:lst-ctn-kix_list_23-8}.lst-kix_list_19-4 > li:before{content:" "}.lst-kix_list_8-1 > li{counter-increment:lst-ctn-kix_list_8-1}ol.lst-kix_list_8-2.start{counter-reset:lst-ctn-kix_list_8-2 0}.lst-kix_list_19-2 > li:before{content:" "}.lst-kix_list_19-3 > li:before{content:" "}ol.lst-kix_list_3-1.start{counter-reset:lst-ctn-kix_list_3-1 0}ul.lst-kix_list_20-0{list-style-type:none}ol.lst-kix_list_6-6.start{counter-reset:lst-ctn-kix_list_6-6 0}.lst-kix_list_7-0 > li{counter-increment:lst-ctn-kix_list_7-0}.lst-kix_list_19-0 > li{counter-increment:lst-ctn-kix_list_19-0}ol.lst-kix_list_1-5.start{counter-reset:lst-ctn-kix_list_1-5 0}.lst-kix_list_2-3 > li{counter-increment:lst-ctn-kix_list_2-3}ol.lst-kix_list_19-8.start{counter-reset:lst-ctn-kix_list_19-8 -1}ol.lst-kix_list_22-4.start{counter-reset:lst-ctn-kix_list_22-4 0}.lst-kix_list_22-7 > li{counter-increment:lst-ctn-kix_list_22-7}ol.lst-kix_list_4-5.start{counter-reset:lst-ctn-kix_list_4-5 0}.lst-kix_list_1-2 > li{counter-increment:lst-ctn-kix_list_1-2}.lst-kix_list_19-8 > li:before{content:" "}ol.lst-kix_list_20-8.start{counter-reset:lst-ctn-kix_list_20-8 0}.lst-kix_list_5-2 > li{counter-increment:lst-ctn-kix_list_5-2}.lst-kix_list_19-5 > li:before{content:" "}.lst-kix_list_19-6 > li:before{content:" "}.lst-kix_list_19-7 > li:before{content:" "}ol.lst-kix_list_8-7.start{counter-reset:lst-ctn-kix_list_8-7 0}ol.lst-kix_list_23-8.start{counter-reset:lst-ctn-kix_list_23-8 0}ol.lst-kix_list_21-5.start{counter-reset:lst-ctn-kix_list_21-5 0}.lst-kix_list_20-5 > li{counter-increment:lst-ctn-kix_list_20-5}.lst-kix_list_19-7 > li{counter-increment:lst-ctn-kix_list_19-7}.lst-kix_list_18-3 > li{counter-increment:lst-ctn-kix_list_18-3}.lst-kix_list_21-6 > li{counter-increment:lst-ctn-kix_list_21-6}ol.lst-kix_list_1-0.start{counter-reset:lst-ctn-kix_list_1-0 0}.lst-kix_list_18-0 > li:before{content:"❖  "}.lst-kix_list_3-0 > li{counter-increment:lst-ctn-kix_list_3-0}.lst-kix_list_18-1 > li:before{content:"" counter(lst-ctn-kix_list_18-1,decimal) ". "}.lst-kix_list_18-2 > li:before{content:"" counter(lst-ctn-kix_list_18-2,decimal) ". "}ol.lst-kix_list_4-0.start{counter-reset:lst-ctn-kix_list_4-0 0}.lst-kix_list_23-4 > li{counter-increment:lst-ctn-kix_list_23-4}ol.lst-kix_list_23-1.start{counter-reset:lst-ctn-kix_list_23-1 0}ol.lst-kix_list_2-4.start{counter-reset:lst-ctn-kix_list_2-4 0}.lst-kix_list_23-1 > li{counter-increment:lst-ctn-kix_list_23-1}ol.lst-kix_list_1-3{list-style-type:none}ul.lst-kix_list_22-0{list-style-type:none}ol.lst-kix_list_1-4{list-style-type:none}.lst-kix_list_2-7 > li:before{content:"" counter(lst-ctn-kix_list_2-7,decimal) ". "}.lst-kix_list_2-7 > li{counter-increment:lst-ctn-kix_list_2-7}ol.lst-kix_list_1-5{list-style-type:none}ol.lst-kix_list_1-6{list-style-type:none}ol.lst-kix_list_1-0{list-style-type:none}.lst-kix_list_2-5 > li:before{content:"" counter(lst-ctn-kix_list_2-5,decimal) ". "}ol.lst-kix_list_1-1{list-style-type:none}ol.lst-kix_list_1-2{list-style-type:none}.lst-kix_list_22-3 > li{counter-increment:lst-ctn-kix_list_22-3}.lst-kix_list_18-6 > li:before{content:"" counter(lst-ctn-kix_list_18-6,decimal) ". "}.lst-kix_list_10-1 > li:before{content:"o  "}.lst-kix_list_21-3 > li{counter-increment:lst-ctn-kix_list_21-3}.lst-kix_list_18-4 > li:before{content:"" counter(lst-ctn-kix_list_18-4,decimal) ". "}.lst-kix_list_18-8 > li:before{content:"" counter(lst-ctn-kix_list_18-8,decimal) ". "}.lst-kix_list_7-7 > li{counter-increment:lst-ctn-kix_list_7-7}ol.lst-kix_list_4-3.start{counter-reset:lst-ctn-kix_list_4-3 0}ol.lst-kix_list_1-7{list-style-type:none}ol.lst-kix_list_1-8{list-style-type:none}.lst-kix_list_10-7 > li:before{content:"▪  "}.lst-kix_list_7-8 > li{counter-increment:lst-ctn-kix_list_7-8}.lst-kix_list_20-1 > li{counter-increment:lst-ctn-kix_list_20-1}.lst-kix_list_10-5 > li:before{content:"▪  "}ol.lst-kix_list_18-6.start{counter-reset:lst-ctn-kix_list_18-6 0}.lst-kix_list_10-3 > li:before{content:"▪  "}ul.lst-kix_list_11-7{list-style-type:none}ul.lst-kix_list_11-6{list-style-type:none}.lst-kix_list_2-6 > li{counter-increment:lst-ctn-kix_list_2-6}ol.lst-kix_list_20-8{list-style-type:none}ol.lst-kix_list_7-3.start{counter-reset:lst-ctn-kix_list_7-3 0}ul.lst-kix_list_11-5{list-style-type:none}ul.lst-kix_list_11-4{list-style-type:none}ul.lst-kix_list_11-3{list-style-type:none}ol.lst-kix_list_20-5{list-style-type:none}ul.lst-kix_list_11-2{list-style-type:none}ol.lst-kix_list_20-4{list-style-type:none}ul.lst-kix_list_11-1{list-style-type:none}ol.lst-kix_list_20-7{list-style-type:none}ul.lst-kix_list_11-0{list-style-type:none}ol.lst-kix_list_20-6{list-style-type:none}.lst-kix_list_9-2 > li:before{content:"▪  "}ol.lst-kix_list_20-1{list-style-type:none}ol.lst-kix_list_20-3{list-style-type:none}ol.lst-kix_list_20-2{list-style-type:none}ol.lst-kix_list_5-7.start{counter-reset:lst-ctn-kix_list_5-7 0}ul.lst-kix_list_11-8{list-style-type:none}.lst-kix_list_20-8 > li:before{content:"" counter(lst-ctn-kix_list_20-8,decimal) ". "}.lst-kix_list_5-5 > li{counter-increment:lst-ctn-kix_list_5-5}.lst-kix_list_9-0 > li:before{content:"●  "}.lst-kix_list_3-4 > li{counter-increment:lst-ctn-kix_list_3-4}.lst-kix_list_20-0 > li:before{content:"●  "}.lst-kix_list_9-6 > li:before{content:"▪  "}.lst-kix_list_9-4 > li:before{content:"▪  "}.lst-kix_list_23-5 > li{counter-increment:lst-ctn-kix_list_23-5}.lst-kix_list_11-3 > li:before{content:"▪  "}ul.lst-kix_list_21-0{list-style-type:none}.lst-kix_list_6-3 > li{counter-increment:lst-ctn-kix_list_6-3}.lst-kix_list_20-6 > li:before{content:"" counter(lst-ctn-kix_list_20-6,decimal) ". "}ol.lst-kix_list_18-4.start{counter-reset:lst-ctn-kix_list_18-4 0}ol.lst-kix_list_1-3.start{counter-reset:lst-ctn-kix_list_1-3 0}ol.lst-kix_list_1-2.start{counter-reset:lst-ctn-kix_list_1-2 0}.lst-kix_list_20-4 > li:before{content:"" counter(lst-ctn-kix_list_20-4,decimal) ". "}.lst-kix_list_11-5 > li:before{content:"▪  "}ol.lst-kix_list_22-7.start{counter-reset:lst-ctn-kix_list_22-7 0}ol.lst-kix_list_6-1.start{counter-reset:lst-ctn-kix_list_6-1 0}.lst-kix_list_20-2 > li:before{content:"" counter(lst-ctn-kix_list_20-2,decimal) ". "}ol.lst-kix_list_21-2.start{counter-reset:lst-ctn-kix_list_21-2 0}.lst-kix_list_9-8 > li:before{content:"▪  "}.lst-kix_list_20-6 > li{counter-increment:lst-ctn-kix_list_20-6}.lst-kix_list_1-1 > li:before{content:"" counter(lst-ctn-kix_list_1-1,decimal) ". "}.lst-kix_list_11-7 > li:before{content:"▪  "}ul.lst-kix_list_10-0{list-style-type:none}.lst-kix_list_8-5 > li{counter-increment:lst-ctn-kix_list_8-5}.lst-kix_list_1-3 > li:before{content:"" counter(lst-ctn-kix_list_1-3,decimal) ". "}ul.lst-kix_list_10-8{list-style-type:none}ol.lst-kix_list_21-8{list-style-type:none}.lst-kix_list_4-8 > li{counter-increment:lst-ctn-kix_list_4-8}ul.lst-kix_list_10-7{list-style-type:none}.lst-kix_list_1-7 > li:before{content:"" counter(lst-ctn-kix_list_1-7,decimal) ". "}ol.lst-kix_list_21-7{list-style-type:none}ul.lst-kix_list_10-6{list-style-type:none}ol.lst-kix_list_2-7.start{counter-reset:lst-ctn-kix_list_2-7 0}ul.lst-kix_list_10-5{list-style-type:none}ul.lst-kix_list_10-4{list-style-type:none}ol.lst-kix_list_21-4{list-style-type:none}ul.lst-kix_list_10-3{list-style-type:none}.lst-kix_list_1-5 > li:before{content:"" counter(lst-ctn-kix_list_1-5,decimal) ". "}ol.lst-kix_list_21-3{list-style-type:none}ul.lst-kix_list_10-2{list-style-type:none}ol.lst-kix_list_21-6{list-style-type:none}ul.lst-kix_list_10-1{list-style-type:none}ol.lst-kix_list_21-5{list-style-type:none}.lst-kix_list_5-6 > li{counter-increment:lst-ctn-kix_list_5-6}ol.lst-kix_list_7-5.start{counter-reset:lst-ctn-kix_list_7-5 0}ol.lst-kix_list_22-6.start{counter-reset:lst-ctn-kix_list_22-6 0}ol.lst-kix_list_21-2{list-style-type:none}ol.lst-kix_list_21-1{list-style-type:none}.lst-kix_list_2-1 > li:before{content:"" counter(lst-ctn-kix_list_2-1,decimal) ". "}.lst-kix_list_19-8 > li{counter-increment:lst-ctn-kix_list_19-8}.lst-kix_list_2-3 > li:before{content:"" counter(lst-ctn-kix_list_2-3,decimal) ". "}ol.lst-kix_list_19-6{list-style-type:none}ol.lst-kix_list_19-7{list-style-type:none}.lst-kix_list_3-1 > li{counter-increment:lst-ctn-kix_list_3-1}ol.lst-kix_list_19-8{list-style-type:none}ol.lst-kix_list_19-2{list-style-type:none}ol.lst-kix_list_19-3{list-style-type:none}ol.lst-kix_list_19-4{list-style-type:none}ol.lst-kix_list_19-5{list-style-type:none}.lst-kix_list_20-8 > li{counter-increment:lst-ctn-kix_list_20-8}ol.lst-kix_list_19-0{list-style-type:none}ol.lst-kix_list_19-1{list-style-type:none}ol.lst-kix_list_7-7.start{counter-reset:lst-ctn-kix_list_7-7 0}.lst-kix_list_3-1 > li:before{content:"" counter(lst-ctn-kix_list_3-1,decimal) ". "}.lst-kix_list_3-2 > li:before{content:"" counter(lst-ctn-kix_list_3-2,decimal) ". "}.lst-kix_list_8-1 > li:before{content:"" counter(lst-ctn-kix_list_8-1,decimal) ". "}ol.lst-kix_list_1-8.start{counter-reset:lst-ctn-kix_list_1-8 0}.lst-kix_list_8-2 > li:before{content:"" counter(lst-ctn-kix_list_8-2,decimal) ". "}.lst-kix_list_6-0 > li{counter-increment:lst-ctn-kix_list_6-0}.lst-kix_list_3-5 > li:before{content:"" counter(lst-ctn-kix_list_3-5,decimal) ". "}.lst-kix_list_21-2 > li:before{content:"" counter(lst-ctn-kix_list_21-2,decimal) ". "}.lst-kix_list_8-5 > li:before{content:"" counter(lst-ctn-kix_list_8-5,decimal) ". "}.lst-kix_list_8-6 > li:before{content:"" counter(lst-ctn-kix_list_8-6,decimal) ". "}.lst-kix_list_2-0 > li{counter-increment:lst-ctn-kix_list_2-0}.lst-kix_list_3-6 > li:before{content:"" counter(lst-ctn-kix_list_3-6,decimal) ". "}.lst-kix_list_21-6 > li:before{content:"" counter(lst-ctn-kix_list_21-6,decimal) ". "}.lst-kix_list_21-7 > li:before{content:"" counter(lst-ctn-kix_list_21-7,decimal) ". "}ol.lst-kix_list_5-0.start{counter-reset:lst-ctn-kix_list_5-0 0}.lst-kix_list_11-2 > li:before{content:"▪  "}ol.lst-kix_list_22-1.start{counter-reset:lst-ctn-kix_list_22-1 0}ol.lst-kix_list_4-2.start{counter-reset:lst-ctn-kix_list_4-2 0}.lst-kix_list_21-3 > li:before{content:"" counter(lst-ctn-kix_list_21-3,decimal) ". "}ol.lst-kix_list_18-7.start{counter-reset:lst-ctn-kix_list_18-7 0}.lst-kix_list_16-6 > li:before{content:"▪  "}.lst-kix_list_4-4 > li{counter-increment:lst-ctn-kix_list_4-4}ol.lst-kix_list_6-4.start{counter-reset:lst-ctn-kix_list_6-4 0}.lst-kix_list_17-1 > li:before{content:"o  "}.lst-kix_list_18-2 > li{counter-increment:lst-ctn-kix_list_18-2}ol.lst-kix_list_5-6.start{counter-reset:lst-ctn-kix_list_5-6 0}.lst-kix_list_22-6 > li{counter-increment:lst-ctn-kix_list_22-6}.lst-kix_list_16-1 > li:before{content:"o  "}ol.lst-kix_list_4-1.start{counter-reset:lst-ctn-kix_list_4-1 0}.lst-kix_list_7-3 > li{counter-increment:lst-ctn-kix_list_7-3}.lst-kix_list_16-2 > li:before{content:"▪  "}.lst-kix_list_16-5 > li:before{content:"▪  "}.lst-kix_list_19-3 > li{counter-increment:lst-ctn-kix_list_19-3}ol.lst-kix_list_7-8.start{counter-reset:lst-ctn-kix_list_7-8 0}ol.lst-kix_list_22-2.start{counter-reset:lst-ctn-kix_list_22-2 0}ol.lst-kix_list_18-8.start{counter-reset:lst-ctn-kix_list_18-8 0}.lst-kix_list_23-7 > li{counter-increment:lst-ctn-kix_list_23-7}.lst-kix_list_3-3 > li{counter-increment:lst-ctn-kix_list_3-3}ol.lst-kix_list_6-3.start{counter-reset:lst-ctn-kix_list_6-3 0}.lst-kix_list_17-2 > li:before{content:"▪  "}ol.lst-kix_list_5-5.start{counter-reset:lst-ctn-kix_list_5-5 0}.lst-kix_list_17-6 > li:before{content:"▪  "}.lst-kix_list_17-5 > li:before{content:"▪  "}.lst-kix_list_6-2 > li{counter-increment:lst-ctn-kix_list_6-2}.lst-kix_list_2-6 > li:before{content:"" counter(lst-ctn-kix_list_2-6,decimal) ". "}.lst-kix_list_22-3 > li:before{content:"" counter(lst-ctn-kix_list_22-3,decimal) ". "}.lst-kix_list_7-1 > li:before{content:"" counter(lst-ctn-kix_list_7-1,decimal) ". "}.lst-kix_list_7-5 > li:before{content:"" counter(lst-ctn-kix_list_7-5,decimal) ". "}.lst-kix_list_19-5 > li{counter-increment:lst-ctn-kix_list_19-5}.lst-kix_list_22-7 > li:before{content:"" counter(lst-ctn-kix_list_22-7,decimal) ". "}ol.lst-kix_list_23-3.start{counter-reset:lst-ctn-kix_list_23-3 0}.lst-kix_list_23-2 > li{counter-increment:lst-ctn-kix_list_23-2}ol.lst-kix_list_5-4.start{counter-reset:lst-ctn-kix_list_5-4 0}.lst-kix_list_18-5 > li:before{content:"" counter(lst-ctn-kix_list_18-5,decimal) ". "}.lst-kix_list_13-6 > li:before{content:"▪  "}ol.lst-kix_list_5-1.start{counter-reset:lst-ctn-kix_list_5-1 0}.lst-kix_list_20-3 > li{counter-increment:lst-ctn-kix_list_20-3}.lst-kix_list_6-7 > li{counter-increment:lst-ctn-kix_list_6-7}.lst-kix_list_1-7 > li{counter-increment:lst-ctn-kix_list_1-7}.lst-kix_list_7-5 > li{counter-increment:lst-ctn-kix_list_7-5}.lst-kix_list_15-6 > li:before{content:"▪  "}.lst-kix_list_22-4 > li{counter-increment:lst-ctn-kix_list_22-4}.lst-kix_list_3-8 > li{counter-increment:lst-ctn-kix_list_3-8}ol.lst-kix_list_6-8.start{counter-reset:lst-ctn-kix_list_6-8 0}.lst-kix_list_10-2 > li:before{content:"▪  "}.lst-kix_list_4-6 > li{counter-increment:lst-ctn-kix_list_4-6}ol.lst-kix_list_1-7.start{counter-reset:lst-ctn-kix_list_1-7 0}.lst-kix_list_1-5 > li{counter-increment:lst-ctn-kix_list_1-5}.lst-kix_list_20-7 > li:before{content:"" counter(lst-ctn-kix_list_20-7,decimal) ". "}ol.lst-kix_list_6-5.start{counter-reset:lst-ctn-kix_list_6-5 0}.lst-kix_list_4-2 > li:before{content:"" counter(lst-ctn-kix_list_4-2,decimal) ". "}.lst-kix_list_4-6 > li:before{content:"" counter(lst-ctn-kix_list_4-6,decimal) ". "}ol.lst-kix_list_23-6.start{counter-reset:lst-ctn-kix_list_23-6 0}.lst-kix_list_15-2 > li:before{content:"▪  "}.lst-kix_list_10-6 > li:before{content:"▪  "}.lst-kix_list_9-1 > li:before{content:"o  "}ol.lst-kix_list_6-7.start{counter-reset:lst-ctn-kix_list_6-7 0}.lst-kix_list_9-5 > li:before{content:"▪  "}.lst-kix_list_12-2 > li:before{content:"▪  "}.lst-kix_list_11-6 > li:before{content:"▪  "}.lst-kix_list_20-3 > li:before{content:"" counter(lst-ctn-kix_list_20-3,decimal) ". "}.lst-kix_list_1-2 > li:before{content:"" counter(lst-ctn-kix_list_1-2,decimal) ". "}ol.lst-kix_list_23-5.start{counter-reset:lst-ctn-kix_list_23-5 0}.lst-kix_list_21-1 > li{counter-increment:lst-ctn-kix_list_21-1}.lst-kix_list_1-0 > li{counter-increment:lst-ctn-kix_list_1-0}.lst-kix_list_8-8 > li{counter-increment:lst-ctn-kix_list_8-8}.lst-kix_list_1-6 > li:before{content:"" counter(lst-ctn-kix_list_1-6,decimal) ". "}.lst-kix_list_18-7 > li{counter-increment:lst-ctn-kix_list_18-7}.lst-kix_list_12-6 > li:before{content:"▪  "}ol.lst-kix_list_23-4.start{counter-reset:lst-ctn-kix_list_23-4 0}.lst-kix_list_2-2 > li:before{content:"" counter(lst-ctn-kix_list_2-2,decimal) ". "}.lst-kix_list_13-2 > li:before{content:"▪  "}ol.lst-kix_list_5-2.start{counter-reset:lst-ctn-kix_list_5-2 0}</style><div class="doc-content" style="background-color:#ffffff;padding:56.7pt 42.5pt 56.7pt 85pt;max-width:467.8pt"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 816.27px; height: 24.07px;"><img alt="" src="https://docs.google.com/drawings/d/ssdXT9vnjf29-ftQYbYAKOw/image?parent=1_iLPALvvlVrt9DQSYXbUeTvoYsfgitG1&amp;rev=1&amp;drawingRevisionAccessToken=RZbb-uBlUc0BYA&amp;h=24&amp;w=816&amp;ac=1" style="width: 816.27px; height: 24.07px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Лекція 5 Робота з Hive. Огляд та архітектура Hive. Таблиці та партиціонування в Hive. Завантаження даних у таблиці Hive.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Використовували різні підходи до використання декларативних мов для роботи з даними (подібно до SQL) на додаток до MapReduce</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Facebook розробила мову типу SQL, названу HIVE</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Yahoo розробила більш процедурну мову, названу PIG</span></p><ul class="lst-kix_list_18-0 start" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Обидва підходи використовують MapReduce як мову опису/виконання робіт</span></li></ul><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Система Hive призначена для організації інформаційних сховищ на базі Hadoop. Система Hive створювалася для того, щоб аналітики, які добре володіють SQL (але слабо знаються на програмуванні на Java), могли виконувати запити до гігантських обсягів даних, що зберігаються Facebook в HDFS. </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">При нормальному використанні Hive перетворює запит SQL на серію завдань MapReduce, які виконуються в кластері Hadoop. Hive упорядковує дані в таблиці, а це відкриває можливості структурування даних, що зберігаються в HDFS. Метадані - наприклад, схеми таблиць - зберігаються в базі даних, яка називається метасховищем.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Для взаємодії з Hive застосовується SQL-подібна мова запитів, яка називається HiveQL. Наприклад, ось як виглядає запит для отримання всіх активних користувачів у таблиці user:</span></p><p style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">INSERT OVERWRITE TABLE user_active</span></p><p style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">SELECT user.*</span></p><p style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">FROM user</span></p><p style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">WHERE user.active = 1;</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Дизайн Hive відображає його призначення - служити як система для управління та пред&#39;явлення запитів до структурованих даних. Побудована за зразком SQL мова ізолює користувача від складнощів програмування для MapReduce. У ньому використовуються знайомі поняття в галузі баз даних: таблиці, рядки, стовпці, схема, що полегшує вивчення. Крім того, якщо Hadoop природно працює з плоскими файлами, Hive здатний використовувати структури каталогів для «секціонування» даних, це підвищує продуктивність деяких запитів. Для підтримки додаткових можливостей, Hive включений новий важливий компонент - метасховище,</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Зазвичай метасховище розміщується у реляційній базі даних.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Hive зосередився в основному на робочих навантаженнях Extract-Transform-Load (ETL) або на пакетних звітах, що складалися з:</span></p><ol class="lst-kix_list_1-0 start" start="1" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">читання великих обсягів даних;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">виконання перетворень над цими даними (наприклад, аналіз даних, консолідація, агрегація);</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">завантаження вихідних даних до інших систем, які використовувалися для подальшого аналізу.</span></li></ol><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Попередні роботи з Hive, представлені дослідницькій спільноті, були зосереджені на його:</span></p><ol class="lst-kix_list_2-0 start" start="1" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">початкової архітектури та реалізації поверх HDFS та MapReduce;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">покращення для усунення численних недоліків продуктивності у вихідній системі, включаючи введення оптимізованого формату файлів по стовпцях, фізичну оптимізацію для зменшення кількості фаз MapReduce у планах запитів та векторизовану модель реалізації для підвищення ефективності виконання.</span></li></ol><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Роботи, виконані для покращення системи за чотирма різними напрямками:</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Підтримка SQL та ACID</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">. Відповідність вимогам SQL є ключовою вимогою для сховищ даних. Таким чином, підтримка SQL у Hive була розширена, включаючи, серед іншого, кореловані підзапити, обмеження цілісності та розширені операції OLAP. У свою чергу, користувачі сховища потребують підтримки вставок, оновлень, видалень та об&#39;єднань своїх окремих записів «як є» (as for as). Hive надає гарантії ACID з ізоляцією моментальних знімків файлової системи віртуальної машини (для «відкату» у працездатний стан) за допомогою диспетчера транзакцій, побудованого поверх Метастора для зберігання схеми та статистики, за яким Hive визначає, як отримати доступ до даних.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Методи оптимізації.</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"> Оптимізація запитів є особливо актуальною для систем керування даними, які використовують декларативні мови запитів, такі як SQL. Замість того, щоб впроваджувати свій власний оптимізатор з нуля, Hive вирішує інтегруватися з Calcite та внести свої можливості оптимізації в систему. Крім того, Hive включає інші методи оптимізації, зазвичай використовуються в середовищах сховищ даних, такі як повторна оптимізація запитів, кешування результатів запитів і перезапис матеріалізованих представлень.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Затримка виконання.</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"> Щоб охопити ширший спектр варіантів використання, включаючи інтерактивні запити, дуже важливо покращити затримку. </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Можливості федерації.</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"> Однією з найважливіших особливостей Hive є здатність забезпечити єдиний рівень SQL поверх багатьох спеціалізованих СУБД, які з&#39;явилися останні кілька років. Завдяки інтеграції з Calcite та покращенням обробника зберігання, Hive може легко виконувати обчислення та зчитувати дані з цих систем. У свою чергу, реалізація легко розширюється та адаптується для підтримки інших систем у майбутньому.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Для взаємодії з Hive є кілька способів, у тому числі веб-інтерфейс (GUI) та Java Database Connectivity (JDBC). Але найчастіше для цієї мети використовується командний інтерфейс (command line interface – CLI).</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">2. АРХІТЕКТУРА СИСТЕМИ</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 554.68px; height: 411.62px;"><img alt="Рисунок 1. Архитектура Apache Hive" src="https://lh3.googleusercontent.com/0d5ZcLly-ChaE6Xw-4dxFO9eKmZ8U5hosOWGiyhpc6dk5EJNuqCRuoTa0rxBUdehzbgZSmrl0m3NUDhbNNkNNaeQD_jlEMf99t6phNTRJzpL86K5ivFidB57kaSCUyI5eY0D4TsX1U4jyr7jENdUZw=s800" style="width: 554.68px; height: 411.62px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Рисунок 1. Архітектура Apache Hive</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Коротко познайомимося з Hive архітектурою. На рис. 1 показано основні компоненти системи.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Збереження даних.</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"> Дані Hive можуть зберігатися в будь-якому з підтримуваних форматів файлів в будь-якій файловій системі, сумісної з Hadoop. На сьогоднішній день найбільш поширеними форматами файлів є ORC та Parquet. У свою чергу, сумісні файлові системи включають HDFS, яка є найчастіше реалізацією розподіленої файлової системи для всіх основних комерційних сховищ хмарних об&#39;єктів, таких як AWS S3 і Blob-об&#39;єктів Azure. Крім того, Hive також може зчитувати та записувати дані в інші автономно використовувані системи обробки, наприклад Druid або HBase.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Каталог даних</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">. Hive зберігає всю інформацію про свої джерела даних за допомогою MetaStore Hive (або HiveMetaStore (HMS), простіше кажучи). У двох словах, HMS це каталог для всіх даних, що запитуються Hive. Він використовує СУБД для збереження інформації та покладається на DataNucleus, реалізацію об&#39;єктно-реляційного відображення Java, щоб спростити підтримку кількох СУБД на серверній частині. Для викликів, які потребують низької затримки, HMS може обійти DataNucleus і запросити RDMBS. API HMS підтримує кілька мов програмування, і служба реалізована з використанням Thrift, програмної платформи, яка забезпечує мову визначення інтерфейсу, механізм генерації коду та реалізацію двійкового протоколу зв&#39;язку.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Змінне середовище обробки даних</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">. Hive став одним з найпопулярніших SQL-движків від Hadoop, він поступово відійшов від MapReduce, щоб підтримувати гнучкіший час виконання обробки, сумісний з YARN. Хоча MapReduce все ще підтримується, в даний час найбільш популярним середовищем виконання для Hive є Tez. Це середовище, яке забезпечує більшу гнучкість, ніж MapReduce, моделюючи обробку даних у вигляді DAG з вершинами, що відображають логіку програми, і ребрами, що представляють передачу даних, подібно до системи Dryad або Hyracks. Крім того, Tez сумісний з LLAP.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 658.02px; height: 151.42px;"><img alt="Рисунок 2. Этапы подготовки запроса в HiveServer2" src="https://lh4.googleusercontent.com/Y3eXmwFhupVny_eFWuVrD7F4jrvLTNFknWVKYkVK-9XVH4reVzOE6JHFlc00cmDmOp_dFoz1qS67SCPks0NRpQP84kKh-K52qk-hgp_Iqg1uLUh_pIJi-et37-ZGsF3rn_iKbp0hYWpx-YLWBMruZg=s800" style="width: 658.02px; height: 151.42px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Рисунок 2. Етапи підготовки запиту в HiveServer2</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">(</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">На рис. 2 показані етапи, через які проходить SQL-запит у HS2, щоб стати виконуваним за планом. Як тільки користувач надсилає запит до HS2, запит обробляється драйвером, який аналізує оператор та генерує логічний план Calcite зсередини його AST. Потім план Calcite оптимізується. 3. ПІДТРИМКА SQL І ACID</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Стандартні транзакції SQL та ACID є критичними вимогами у корпоративних сховищах даних. </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">3.1 Підтримка SQL</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Щоб забезпечити заміну традиційних сховищ даних, Hive розширили, щоб підтримувати більше функцій ядра SQL. Hive використовує внутрішню модель даних, що підтримує всі основні типи атомарних даних SQL, а також неатомарні типи, такі як STRUCT, ARRAY і MAP. Крім того, кожен новий випуск Hive збільшував підтримку важливих конструкцій, що є частиною специфікації SQL. Наприклад, існує розширена підтримка корелированных підзапитів, що посилаються на стовпці із зовнішнього запиту, розширених операцій OLAP, таких як набори угруповань або інтерфейсні функції, операції набору та обмеження цілісності. З іншого боку, Hive зберіг безліч функцій вихідної мови запитів, які були цінні для її бази користувача. Однією з найпопулярніших функцій є можливість вказати фізичне компонування сховища під час створення таблиці за допомогою пропозиції PARTITIONED BY &lt;COLUMNS&gt;. У двох словах, пропозиція дозволяє користувачеві розділяти таблицю по горизонталі. Потім Hive зберігає дані для кожного набору значень розділів в іншому каталозі файлової системи. Щоб проілюструвати цю ідею, розглянемо таке визначення таблиці та відповідний фізичний макет, зображений на рис. 3: </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 433.87px; height: 542.80px;"><img alt="https://habrastorage.org/r/w1560/getpro/habr/upload_files/350/de9/149/350de9149712ac9d9fb5d6878409fd25.png" src="https://lh4.googleusercontent.com/15V4aTZyf28pzguBkGqmUW91lg2vIR-qX9UCgALlHmPRjgnR00IDUziC-vdSS9VSJut4YeTid8kTPAal48_773pZgbSlekjr2FMpfCF4YMarYI0LgVZmhLqzfeysVXy9IWOE7KAGVsKG8-_slmUmLg=s800" style="width: 433.87px; height: 542.80px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Перевага використання пропозиції PARTITIONED BY полягає в тому, що Hive зможе легко пропустити сканування повних розділів для запитів, які ці значення фільтрують.</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">CREATE</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">TABLE </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">store_sales (</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">sold_date_sk </span><span style="color:#f5871f;font-weight:400">INT</span><span style="color:#4d4d4c;font-weight:400">, item_sk </span><span style="color:#f5871f;font-weight:400">INT</span><span style="color:#4d4d4c;font-weight:400">, customer_sk </span><span style="color:#f5871f;font-weight:400">INT</span><span style="color:#4d4d4c;font-weight:400">, store_sk </span><span style="color:#f5871f;font-weight:400">INT</span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">,</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">quantity </span><span style="color:#f5871f;font-weight:400">INT</span><span style="color:#4d4d4c;font-weight:400">, list_price </span><span style="color:#f5871f;font-weight:400">DECIMAL</span><span style="color:#4d4d4c;font-weight:400">(</span><span style="color:#f5871f;font-weight:400">7</span><span style="color:#4d4d4c;font-weight:400">,</span><span style="color:#f5871f;font-weight:400">2</span><span style="color:#4d4d4c;font-weight:400">), sales_price </span><span style="color:#f5871f;font-weight:400">DECIMAL</span><span style="color:#4d4d4c;font-weight:400">(</span><span style="color:#f5871f;font-weight:400">7</span><span style="color:#4d4d4c;font-weight:400">,</span><span style="color:#f5871f;font-weight:400">2</span><span style="color:#4d4d4c;font-weight:400">)) PARTITIONED </span><span style="color:#8959a8">BY</span><span style="color:#4d4d4c;font-weight:400">(sold_date_sk </span><span style="color:#f5871f;font-weight:400">INT</span><span style="color:#4d4d4c;font-weight:400">);</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">3.2 Використання ACID</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Спочатку Hive підтримував лише вставку та видалення повних розділів з таблиці. Хоча відсутність операцій на рівні рядків була прийнятною для робочих навантажень ETL, у міру розвитку Hive та для підтримки багатьох традиційних робочих навантажень сховищ даних зросли вимоги до повної підтримки DML та транзакцій ACID. Тому Hive тепер включає підтримку виконання інструкцій INSERT, UPDATE, DELETE та MERGE. Він забезпечує гарантії ACID за допомогою ізоляції миттєвих знімків, що є гарантією того, що на практиці будуть зчитані останні зафіксовані значення, які існували на момент її запуску, а сама операція успішно зафіксується лише якщо оновлення не конфліктують з якимись паралельними оновлення, зроблені після цього знімка. Це важливо для читання та чітко визначеної семантики у разі збою з використанням вбудованого в систему керування транзакціями. В даний час транзакції можуть охоплювати лише один оператор; планується підтримувати транзакції з кількома операторами у найближчому майбутньому. Проте можна виконувати запис у кілька таблиць у межах однієї транзакції з допомогою операторів Hive з кількома вставками. Основні проблеми, які необхідно подолати за підтримки операцій на рівні рядків у Hive:</span></p><ol class="lst-kix_list_3-0 start" start="1" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">відсутність менеджера транзакцій у системі;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">відсутність підтримки оновлень файлів у базовій файловій системі.</span></li></ol><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Нижче наведено більш детальну інформацію про впровадження ACID у Hive і про те, як були вирішені ці проблеми.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Управління транзакціями та блокуваннями</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">. HIVE зберігає інформацію про транзакції та стан блокування в HMS. Він використовує глобальний ідентифікатор транзакції чи TxnId, тобто монотонно збільшується величину, що генерується MetaStore, для кожної транзакції, що виконується в системі. У свою чергу кожне значення TxnId зіставляється з одним або декількома ідентифікаторами запису або ідентифікаторами запису. Ідентифікатор запису – це монотонно зростаюча величина, що також генерується MetaStore, але в межах області завдання таблиці. Ідентифікатор запису зберігається з кожним записом транзакції; всі записи, записані однією і тією ж транзакцією в одну й ту саму таблицю, мають той самий ідентифікатор запису. У свою чергу файли з однаковим ідентифікатором запису ідентифікуються унікальним чином за допомогою ідентифікатора файлу, у той час, як кожен запис у файлі ідентифікується унікальним чином за допомогою поля RowId. Зверніть увагу, що комбінація WriteId, FileId та RowId однозначно ідентифікує кожен запис у таблиці. Операція видалення в Hive реалізується як вставка поміченого запису, яка вказує на унікальний ідентифікатор запису, що видаляється.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Для досягнення ізоляції моментальних знімків HS2 отримує логічний моментальний знімок даних, які потрібно прочитати під час виконання запиту. Знімок представлений списком транзакцій, що містить найвищий ранг TxnId на даний момент (High Water Mark) та набір відкритих та перерваних транзакцій під ним. Для кожної таблиці, яку має прочитати запит, HS2 спочатку генерує список WriteId зі списку транзакцій, зв&#39;язавшись із HMS; Список WriteId аналогічний до списку транзакцій, але в межах однієї таблиці. Кожна операція сканування прив&#39;язана до списку WriteId під час компіляції. Зчитувачі в цьому скануванні пропускатимуть рядки, ідентифікатор запису яких вищий за верхній водяний знак або є частиною набору відкритих і перерваних транзакцій. Причина збереження як глобальних ідентифікаторів,</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Ступінь деталізації блокування є критерієм для поділу (секціонування) таблиць, тоді як повна таблиця має бути заблокована для нерозділених таблиць. HS2 потрібно лише для отримання ексклюзивних блокувань за операціями, які порушують роботу під час читання та запису, таких як видалення РОЗДІЛІВ або інструкцій DROP TABLE. Решта поширених операцій просто отримують загальні блокування. Оновлення та видалення використовують оптимістичний дозвіл конфліктів, відстежуючи свої набори записів та вирішуючи конфлікт під час фіксації (дозволяючи першій фіксації виграти).</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Розташування даних та файлів</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">. Hive зберігає дані для кожної таблиці та розділу в окремому каталозі (рисунок 3). Використовуються різні сховища або каталоги в кожній таблиці або кожному розділі для підтримки одночасних операцій читання та запису: base та delta, які, у свою чергу, можуть працювати з одним або декількома файлами. </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Ущільнення.</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"> Стиснення – процес у Hive, який поєднує файли в каталогах delta з іншими файлами у каталогах delta (результат називається незначним ущільненням) або файлів у каталогах delta з файлами у базових каталогах (результат називається основним ущільненням). Найважливішими причинами періодичного запуску стиснення є:</span></p><ol class="lst-kix_list_4-0 start" start="1" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">зменшення кількості каталогів та файлів у таблицях, які без стиснення можуть вплинути на продуктивність файлової системи;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">скорочення зусиль зчитування щодо об&#39;єднання файлів під час виконання запиту;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">скорочення набору відкритих та перерваних ідентифікаторів TXNID та ідентифікаторів запису, пов&#39;язаних з кожним знімком, тобто. основне стиснення видаляє історію, збільшуючи ідентифікатор TxnId, коли всі записи в таблицях, як відомо, є дійсними.</span></li></ol><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">4. ОПТИМІЗАЦІЯ ЗАПИТІВ</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Хоча підтримка оптимізації в початкових версіях Hive була обмежена, очевидно, що розробка внутрішніх компонентів її виконання недостатня для забезпечення ефективної продуктивності. Таким чином, в даний час проект включає багато складних методів, зазвичай використовуються в системах РБД. </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">4.1 Оптимізатор на основі правил та витрат</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Спочатку Apache Hive виконала кілька перезаписів підвищення продуктивності під час аналізу вхідного оператора SQL. Крім того, вона містить оптимізатор на основі правил, який застосовував прості перетворення до фізичного плану, згенерованого на основі запиту. Наприклад, метою багатьох із цих оптимізацій була спроба мінімізувати витрати на перетасовування даних, критичну операцію в двигуні MapReduce. Були й інші оптимізації для видалення предикатів фільтрації, проектування стовпців, що не використовуються, і видалення розділів. Хоча це було ефективно для деяких запитів, робота з поданням фізичного плану робила реалізацію складних перезаписів, таких як зміна порядку з&#39;єднань, спрощення та поширення предикатів або перезапис на основі матеріалізованого представлення, надмірно складного.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">З цієї причини було введено нове представлення плану та оптимізатор на базі Apache Calcite. Calcite – це модульний та розширюваний оптимізатор запитів із вбудованими елементами, які можна комбінувати у різний спосіб для створення власної логіки оптимізації. До них відносяться різні правила переписування, планувальники та моделі витрат.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Calcite надає два різні механізми планування:</span></p><ol class="lst-kix_list_5-0 start" start="1" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">планувальник на основі витрат – запуск правила перезапису з метою зниження загальної вартості вираження;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">вичерпний планувальник – запуску правила, доки створить вираз, яке більше змінюється жодними правилами.</span></li></ol><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Правила перетворення працюють нечітко з обома планувальниками.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111">Статистика.</span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"> Статистичні дані таблиці зберігаються в HMS та надаються Calcite під час планування. До них відносяться кількість елементів таблиці та кількість різних значень, мінімальне та максимальне значення для кожного стовпця. Статистика зберігається в такий спосіб, щоб її можна було комбінувати у додатковий спосіб, тобто майбутні вставки, а також дані з кількох розділів можуть змінювати наявну статистику. Діапазон та потужність можуть бути об&#39;єднані. Для різних значень HMS використовує представлення бітового масиву на основі HyperLogLog++, яке може бути поєднане без втрати точності апроксимації.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">4.2 Повторна оптимізація запитів</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Hive підтримує повторну оптимізацію запитів, коли під час виконання виникають певні помилки. Зокрема вона реалізує дві незалежні стратегії повторної оптимізації.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Перша стратегія змінює певні параметри конфігурації для всіх повторних запитів. Наприклад, користувач може вибрати примусове використання всіх з&#39;єднань при повторному виконанні запиту для певного алгоритму, наприклад, хешування з сортуванням-злиттям. Це може бути корисним, коли відомі певні значення конфігурації, що дозволяють підвищити надійність виконання запитів.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Друга стратегія (повторна оптимізація) ґрунтується на статистиці, отриманій під час виконання. Під час планування запиту оптимізатор оцінює розмір проміжних результатів у плані з урахуванням статистики, отриманої з HMS. Якщо ці оцінки не точні, оптимізатор може припуститися помилок планування, наприклад, неправильний вибір алгоритму з&#39;єднання або виділення пам&#39;яті. Це, у свою чергу, може призвести до зниження продуктивності та помилок виконання. Hive збирає статистику часу виконання кожного оператора в плані. Якщо під час виконання запиту виявляється якась вищезгадана проблема, запит повторно оптимізується за допомогою статистики часу виконання та виконується знову.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">4.3 Кеш результатів запиту</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Узгодженість транзакцій сховища дозволяє Hive повторно використовувати результати раніше виконаного запиту, використовуючи внутрішній стан транзакцій таблиць, що беруть участь. Кеш запитів забезпечує переваги масштабованості при роботі з інструментами бізнес-аналітики, які генерують ідентичні запити, що повторюються.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">4.4. Здійснені представлення та переписування</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Традиційно одним із найбільш потужних методів, що використовуються для прискорення обробки запитів у сховищах даних, є попереднє обчислення відповідних здійснених (реалізованих) представлень.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Hive Apache підтримує здійснені представлення та автоматичний перезапис запитів на основі цих реалізацій. Оптимізатор використовує Calcite для автоматичного створення повних і частково містять перезапис виразів запитів SelectProject-Join-Aggregate (SPJA) (див. рисунок 4). Алгоритм перезапису використовує інформацію про обмеження цілісності, оголошену в Hive, наприклад первинний ключ, зовнішній ключ, унікальний ключ, а не null для створення додаткових допустимих перетворень. </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 518.88px; height: 299.99px;"><img alt="Рисунок 4. Материализованное определение представления (а) образец
полностью (б) и частично" src="https://lh6.googleusercontent.com/Viqh-kqyNFDLLWwO0OwNokBRyu20ir487a37gp_Y7gfrtZW4O8cI-igc6T6BHoSFkGQgnjhp32cSHRtiFwGkUn_FtLSgOj2A6X4YrBfE6PGqAr67l4iaXAyyIVU8zMUeedDepnCAndu322ApGy7TCQ=s800" style="width: 518.88px; height: 299.99px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Рисунок 4. Матеріалізоване визначення представлення (а) зразок повністю (б) та частково</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">4.5. Оптимізація спільної роботи</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Hive здатний ідентифікувати перевираження, що перекриваються в плані виконання даного запиту, обчислюючи їх тільки один раз і повторно використовуючи їх результати. </span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">4.6. Динамічне скорочення напівз&#39;єднань</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Скорочення напівз&#39;єднань (півжиття активності з&#39;єднань) – традиційний метод, який використовується зменшення розміру проміжних результатів під час виконання запиту. Оптимізація особливо корисна БД зіркової архітектури з однією або декількома таблицями вимірювань. Запити до цих БД зазвичай поєднуються з таблицями фактів та вимірювань, які логічно фільтруються за допомогою предикатів в одному або кількох стовпцях. Однак ці стовпці не використовуються в умовах з&#39;єднання, отже, фільтр за таблицею фактів не може бути створений статично. Наступний SQL-запит показує приклад такого з&#39;єднання між таблицями фактів store_sales та store_returns та таблицею вимірювання номенклатури:</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">SELECT</span><span style="color:#4d4d4c;font-weight:400">ss_customer_sk, </span><span style="color:#f5871f;font-weight:400">SUM</span><span style="color:#4d4d4c;font-weight:400">(ss_sales_price)</span><span style="color:#8959a8">AS </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">sum_sales</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">FROM </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">store_sales, store_returns, item</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">WHERE </span><span style="color:#4d4d4c;font-weight:400">ss_item_sk = sr_item_sk </span><span style="color:#8959a8">AND</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">ss_ticket_number = sr_ticket_number </span><span style="color:#8959a8">AND</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">ss_item_sk = i_item_sk </span><span style="color:#8959a8">AND</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">i_category =</span><span style="color:#718c00;font-weight:400">&#39;Sports&#39;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">GROUP</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">BY </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">ss_customer_sk</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">ORDER</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">BY </span><span style="color:#4d4d4c;font-weight:400">sum_sales </span><span style="color:#8959a8">DESC</span><span style="color:#4d4d4c;font-weight:400">;</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Застосовуючи скорочення напівз&#39;єднань, Hive обчислює відфільтрований підвираз (у наведеному вище прикладі - фільтр у таблиці елементів), та був значення, отримані з допомогою висловлювання, використовуються пропуску записів читання з інших таблиць.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Рисунок 5. Адресація кешу в LLAP.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Хоча в системі може бути визначено кілька планів ресурсів, в даний момент лише один з них може бути активний для даного розгортання. Плани ресурсів зберігаються Hive у HMS.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">План ресурсів складається з:</span></p><ol class="lst-kix_list_6-0 start" start="1" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">одного або кількох пулів ресурсів з максимальною кількістю ресурсів та кількістю одночасних запитів на пул;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">зіставлень, які направляють вхідні запити до пулів на основі певних властивостей запиту, таких як користувач, група або програма;</span></li><li style="padding:0;list-style-position:inside;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">тригерів, які ініціюють дію, таке як знищення запитів у пулі або переміщення запитів з одного пулу до іншого, на основі показників запитів, зібраних під час виконання.</span></li></ol><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Хоча запити гарантовано отримують частки ресурсів кластера, визначені в пулах, менеджер робочого навантаження намагається запобігти недостатньому використанню кластера. Зокрема, запиту можуть бути призначені незайняті ресурси з пулу, якому він не був призначений, доки наступний запит, зіставлений з цим пулом, не вимагатиме їх.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Як приклад розглянемо таке визначення плану ресурсів для виробничого кластера:</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">CREATE </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">RESOURCE PLAN daytime;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">CREATE </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">POOL daytime.bi</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">WITH </span><span style="color:#4d4d4c;font-weight:400">alloc_fraction=</span><span style="color:#f5871f;font-weight:400">0.8</span><span style="color:#4d4d4c;font-weight:400">, query_parallelism=</span><span style="color:#f5871f;font-weight:400">5</span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">CREATE </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">POOL daytime.etl</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">WITH </span><span style="color:#4d4d4c;font-weight:400">alloc_fraction=</span><span style="color:#f5871f;font-weight:400">0.2</span><span style="color:#4d4d4c;font-weight:400">, query_parallelism=</span><span style="color:#f5871f;font-weight:400">20</span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">CREATE </span><span style="color:#4d4d4c;font-weight:400">RULE downgrade </span><span style="color:#8959a8">IN </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">daytime</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">WHEN </span><span style="color:#4d4d4c;font-weight:400">total_runtime &gt;</span><span style="color:#f5871f;font-weight:400">3000</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">THEN </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">MOVE etl;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">ADD </span><span style="color:#4d4d4c;font-weight:400">RULE downgrade</span><span style="color:#8959a8">TO</span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">bi;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">CREATE </span><span style="color:#4d4d4c;font-weight:400">APPLICATION MAPPING visualization_app </span><span style="color:#8959a8">IN </span><span style="color:#4d4d4c;font-weight:400">daytime </span><span style="color:#8959a8">TO </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">bi;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">ALTER </span><span style="color:#4d4d4c;font-weight:400">PLAN daytime </span><span style="color:#8959a8">SET</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">DEFAULT </span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">POOL = etl;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">ALTER </span><span style="color:#4d4d4c;font-weight:400">RESOURCE PLAN daytime ENABLE ACTIVATE;</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">6. ОБ&#39;ЄДНАНА СИСТЕМА ЗБЕРІГАННЯ (FEDERATION)</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">За останнє десятиліття спостерігається зростання поширення спеціалізованих систем управління даними, які стали популярними, тому що вони забезпечують більш економічну продуктивність для свого конкретного випадку використання, ніж традиційні СУБД.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">На додаток до своїх власних можливостей обробки, Hive може виступати посередником, оскільки він призначений для підтримки запитів щодо кількох незалежних СУБД. Переваги об&#39;єднання доступу до цих систем через Hive численні. Розробники програм можуть вибрати поєднання кількох систем для досягнення бажаної продуктивності та функціональності, однак кодувати їм необхідно лише для одного інтерфейсу. Таким чином, програми стають незалежними від базових систем даних, що забезпечує більшу гнучкість при подальшій зміні систем. Hive може використовуватися для переміщення та перетворення даних між різними системами, усуваючи необхідність у сторонніх інструментах,</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">По-перше, якщо джерело даних вже існує у Druid, ми можемо зіставити йому зовнішню Hive-таблицю за допомогою простого оператора:</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">CREATE</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">EXTERNAL</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">TABLE</span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">druid_table_1</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">STORED</span><span style="color:#8959a8">BY</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#718c00;font-weight:400">&#39;org.apache.hadoop.hive.druid.DruidStorageHandler&#39;</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">TBLPROPERTIES (</span><span style="color:#718c00;font-weight:400">&#39;druid.datasource&#39;</span><span style="color:#4d4d4c;font-weight:400">=</span><span style="color:#718c00;font-weight:400">&#39;my_druid_source&#39;</span><span style="color:#4d4d4c;font-weight:400">);</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Зверніть увагу, що нам не потрібно вказувати імена або типи стовпців для джерела даних, оскільки вони автоматично виводяться з метаданих Druid. У свою чергу, ми можемо створити джерело даних у Druid з Hive за допомогою простого затвердження таким чином:</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#8959a8">CREATE</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">EXTERNAL</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#8959a8">TABLE</span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">druid_table_2 (</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">__time </span><span style="color:#f5871f;font-weight:400">TIMESTAMP</span><span style="color:#4d4d4c;font-weight:400">, dim1 </span><span style="color:#f5871f;font-weight:400">VARCHAR</span><span style="color:#4d4d4c;font-weight:400">(</span><span style="color:#f5871f;font-weight:400">20</span><span style="color:#4d4d4c;font-weight:400">), m1 </span><span style="color:#f5871f;font-weight:400">FLOAT</span><span style="color:#4d4d4c;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">)</span></p><p style="border-right-style:solid;color:#000000;border-top-width:0.5pt;border-bottom-color:#e5e8ec;font-weight:700;padding-left:9pt;border-left-color:#e5e8ec;font-size:14pt;background-color:#fbfdff;text-indent:35.5pt;border-left-style:solid;border-top-color:#e5e8ec;font-family:&quot;Times New Roman&quot;;orphans:2;text-align:justify;padding-top:8pt;margin:0;border-right-width:0.5pt;padding-bottom:8pt;line-height:1.5;border-right-color:#e5e8ec;border-left-width:0.5pt;border-top-style:solid;border-bottom-width:0.5pt;border-bottom-style:solid;widows:2;padding-right:9pt"><span style="color:#4d4d4c;font-weight:400">STORED </span><span style="color:#8959a8">BY</span><span style="color:#4d4d4c;font-weight:400"> </span><span style="color:#718c00;font-weight:400">&#39;org.apache.hadoop.hive.druid.DruidStorageHandler&#39;</span><span style="color:#4d4d4c;font-weight:400">;</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">6.2. Обчислення прискорення за допомогою Calcite</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Однією з найпотужніших функцій Hive є можливість використовувати адаптери Calcite  для перенесення складних обчислень у системи, що підтримуються, генерації запитів на мовах, що підтримуються ними.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.11px; height: 176.44px;"><img alt="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e5f/246/87d/e5f24687d497ec90594a9427c59d052d.png" src="https://lh5.googleusercontent.com/xRRoyWB6NJbY9tzaGv97yt65ODunZYj5M_ASeGjMnp3Up_4S4rblh4j0zZiYSkIbFfMpjv1hsXWMHKz-GcM8Fwc5dk53DfTqJnfTx7e6wii1t1cVPoUvkS9RDEiM_dJJQZ5DwTfAV-PwisPrOxIZew=s800" style="width: 480.11px; height: 176.44px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 652.93px; height: 444.33px;"><img alt="Рисунок 6. Пример федерации запросов в Hive" src="https://lh4.googleusercontent.com/I3rH-D7SXi_2v_VowSdbmkh02f3OFDU-CAd22BQ64uYUrqjDs7QDlf8O-_uNjfljxrKJsIY6KVMFBgYtHdsVxN_IajhHR_9XKzBOaByPweQ0qrcmB-MLvkqYYpJ8ubUNzEGxX4dpJKzEEkcS6bX4nw=s800" style="width: 652.93px; height: 444.33px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Рисунок 6. Приклад федерації запитів у Hive</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">ВИСНОВКИ</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Ранній успіх Apache Hive був зумовлений здатністю використання паралелізму для пакетних операцій із добре відомим інтерфейсом. Це спростило завантаження даних та керування ними, витончено справляючись із вузловими, програмними та апаратними збоями без дорогого ремонту або часу відновлення.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Спільнота розширила корисність системи від інструменту ETL до повноцінного сховища даних корпоративного рівня. Ми описали додавання транзакційної системи, яка добре підходить для змін даних, які потрібні в базах даних схеми «зірка». Ми показали основні покращення середовища виконання, необхідні для забезпечення затримки запитів та паралелізму в галузі інтерактивної роботи. Ми також описали методи оптимізації на основі витрат, необхідних для обробки сучасних ієрархій уявлень та операцій з великими даними. Нарешті, ми показали, як Hive можна використовувати сьогодні як реляційний інтерфейс для декількох систем зберігання та обробки даних. Все це реалізується без будь-яких збитків для початкових характеристик системи, які зробили її популярною. Архітектура та принципи проектування Apache Hive довели свою ефективність у сучасному аналітичному ландшафті. Ми вважаємо, що він продовжуватиме процвітати в нових середовищах розгортання та зберігання у міру їх появи, як це показує сьогодні з контейнеризацією та хмарою.</span></p><p style="padding-top:0pt;margin:0;color:#000000;font-weight:700;padding-left:0;font-size:14pt;padding-bottom:10pt;line-height:1.1500000000000001;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:left;padding-right:0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 615.33px; height: 24.07px;"><img alt="" src="https://docs.google.com/drawings/d/sZ6JewE5QznIEoiF31o7fyA/image?parent=1_iLPALvvlVrt9DQSYXbUeTvoYsfgitG1&amp;rev=1&amp;drawingRevisionAccessToken=IhNEd4sISs0_zA&amp;h=24&amp;w=615&amp;ac=1" style="width: 615.33px; height: 24.07px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:center"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig – Огляд</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig – це абстракція над MapReduce. Це інструмент / платформа, яка використовується для аналізу великих наборів даних, що становлять їх як потоки даних. Свиня зазвичай використовується зHadoop; ми можемо виконувати всі операції з даними Hadoop, використовуючи Apache Pig.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Для написання програм аналізу даних Pig надає мову високого рівня, відому як Pig Latin. Ця мова надає різні оператори, за допомогою яких програмісти можуть розробляти власні функції для читання, запису та обробки даних.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Щоб аналізувати дані за допомогою Apache Pig, програмістам необхідно писати сценарії мовою Pig Latin. Всі ці скрипти внутрішньо перетворені на завдання Map та Reduce. Apache Pig має компонент, відомий як Pig Engine, який приймає латинські сценарії Pig як вхідні дані і перетворює ці сценарії на завдання MapReduce.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Навіщо Apache Pig?</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Програмісти, які не дуже хороші в Java, зазвичай борються з роботою з Hadoop, особливо під час виконання будь-яких завдань MapReduce. Apache Pig – благо для всіх програмістів.</span></p><ul class="lst-kix_list_20-0 start" style="padding:0;margin:0"><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">ВикористовуючиP ig Latin, програмісти можуть легко виконувати завдання MapReduce, не вводячи складних кодів у Java.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig використовує підхід з кількома запитами, тим самим скорочуючи довжину кодів. Наприклад, операцію, яка вимагатиме від вас введення 200 рядків коду (LoC) в Java, можна легко виконати, ввівши лише 10 LoC в Apache Pig. Зрештою Apache Pig скорочує час розробки майже в 16 разів.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Pig Latin – це SQL-подібна мова, і Apache Pig легко освоїти, якщо ви знайомі з SQL.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig надає безліч вбудованих операторів для підтримки операцій з даними, таких як об&#39;єднання, фільтри, впорядкування і т. д. Крім того, він також надає вкладені типи даних, такі як кортежі, сумки та карти, які відсутні в MapReduce.</span></li></ul><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:center"><span style="color:#2a2f35">Особливості </span><span style="color:#000000;font-weight:400">Pig</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig постачається з наступними функціями –</span></p><ul class="lst-kix_list_21-0 start" style="padding:0;margin:0"><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Багатий набір операторів – надає безліч операторів до виконання таких операцій, як об&#39;єднання, сортування, фільтрація тощо.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Простота програмування – Pig Latin схожий на SQL, і його легко написати, якщо ви добре знаєтеся на SQL.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Можливості оптимізації – завдання в Apache Pig автоматично оптимізують їхнє виконання, тому програмістам необхідно зосередитися лише на семантиці мови.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Розширюваність – Використовуючи існуючі оператори, користувачі можуть розробляти власні функції для читання, обробки та запису даних.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">UDF&#39;s – Pig надає можливість створювати функції користувача іншими мовами програмування, таких як Java, а також викликати або вбудовувати їх у сценарії Pig.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Обробляє всі види даних – Apache Pig аналізує всі види даних як структурованих, так і неструктурованих. Він зберігає результати HDFS.</span></li></ul><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:center"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig Vs MapReduce</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Нижче наведено основні відмінності між Apache Pig і MapReduce.</span></p><a id="t.fc7bab6cf6de9a27453fdb6f660b1defd4f39754"></a><a id="t.0"></a><table style="margin-left:-3.7pt;border-spacing:0;border-collapse:collapse;margin-right:auto"><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:230.5pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:center"><span style="color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:269.4pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:center"><span style="color:#000000;font-weight:400">MapReduce</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:230.5pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig – це мова потоків даних.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:269.4pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">MapReduce – це парадигма обробки даних.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:230.5pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Це мова високого рівня.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:269.4pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">MapReduce низькорівневий та жорсткий.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:230.5pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Виконати операцію з&#39;єднання Apache Pig досить просто.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:269.4pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">У MapReduce досить складно виконати операцію з&#39;єднання між наборами даних.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:230.5pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Будь-який програміст-початківець з базовими знаннями SQL може зручно працювати з Apache Pig.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:269.4pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Експозиція на Java має працювати з MapReduce.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:230.5pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig використовує підхід із кількома запитами, тим самим значно скорочуючи довжину кодів.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:269.4pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">MapReduce вимагатиме майже в 20 разів більше кількості рядків для виконання того ж завдання.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:230.5pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Немає потреби у компіляції. При виконанні кожен оператор Apache Pig внутрішньо перетворюється на завдання MapReduce.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:269.4pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Завдання MapReduce мають тривалий процес компіляції.</span></p></td></tr></table><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:center"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig Vs SQL</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Нижче наведено основні відмінності між Apache Pig та SQL.</span></p><a id="t.c20b17c00fe700e06e97055758613520a2f1415e"></a><a id="t.1"></a><table style="margin-left:-3.7pt;border-spacing:0;border-collapse:collapse;margin-right:auto"><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:251.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:center"><span style="color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:212.6pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:center"><span style="color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">SQL</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:251.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Свиня латинь єпроцедурною мовою.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:212.6pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">SQL є декларативною мовою.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:251.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">В Apache Pig схема є необов&#39;язковою. Ми можемо зберігати дані без розробки схеми (значення зберігаються як $01, $02 тощо. буд.)</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:212.6pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Схема обов&#39;язкова SQL.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:251.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Модель даних в Apache Pig євкладеної реляційної.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:212.6pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Модель даних, що використовується в SQL,є плоскою реляційною.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:251.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig надає обмежені можливості дляоптимізації запитів.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:212.6pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Існує більше можливостей для оптимізації запитів у SQL.</span></p></td></tr></table><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">На додаток до вищезгаданих відмінностей, Apache Pig Latin –</span></p><ul class="lst-kix_list_22-0 start" style="padding:0;margin:0"><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Дозволяє розколи у конвеєрі.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Дозволяє розробникам зберігати дані у будь-якому місці конвеєра.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Оголошує плани виконання.</span></li><li style="padding:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Надає оператори для виконання функцій ETL (витяг, перетворення та завантаження).</span></li></ul><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig Vs Hive</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig та Hive використовуються для створення робочих місць MapReduce. А в деяких випадках Hive працює з HDFS аналогічно до Apache Pig. У таблиці ми перерахували кілька важливих моментів, які відрізняють Apache Pig від Hive.</span></p><a id="t.80faa834afecf4259eedf6dc97d440e3ae021362"></a><a id="t.2"></a><table style="margin-left:-3.7pt;border-spacing:0;border-collapse:collapse;margin-right:auto"><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:258.9pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:center"><span style="color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:219.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:center"><span style="color:#2a2f35">Hive</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:258.9pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig використовує мовуPig Latin. Спочатку він був створений у Yahoo.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:219.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Hive використовує мовуHiveQL. Спочатку він був створений на Facebook.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:258.9pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Pig Latin – це мова потоків даних.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:219.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">HiveQL – це мова обробки запитів.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:258.9pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Свиня латина є процедурною мовою, і вона відповідає парадигмі конвеєра.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:219.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">HiveQL – декларативна мова.</span></p></td></tr><tr style="height:0pt"><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:258.9pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig може обробляти структуровані, неструктуровані та напівструктуровані дані.</span></p></td><td colspan="1" rowspan="1" style="border-right-style:solid;padding:3.7pt 3.7pt 3.7pt 3.7pt;border-bottom-color:#dddddd;border-top-width:1pt;border-right-width:1pt;border-left-color:#dddddd;vertical-align:top;border-right-color:#dddddd;border-left-width:1pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:1pt;width:219.8pt;border-top-color:#dddddd;border-bottom-style:solid"><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;font-family:&quot;Times New Roman&quot;;line-height:1.5;orphans:2;widows:2;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Вулик переважно для структурованих даних.</span></p></td></tr></table><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:center"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Програми Apache Pig</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig зазвичай використовується дослідниками даних для виконання завдань, що включають спеціальну обробку та швидке створення прототипів. Apache Pig використовується</span></p><ul class="lst-kix_list_23-0 start" style="padding:0;margin:0"><li style="padding:0;list-style-position:inside;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Для обробки величезних джерел даних, таких як веб-журнали.</span></li><li style="padding:0;list-style-position:inside;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Виконати обробку даних для пошукових платформ.</span></li><li style="padding:0;list-style-position:inside;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;margin-right:0;background-color:#ffffff;margin-left:36pt;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;margin-top:0;orphans:2;margin-bottom:0;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Для обробки чутливих на час завантажень даних.</span></li></ul><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig – Архітектура</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Мова, що використовується для аналізу даних у Hadoop з використанням Pig, відома як Pig Latin. Це мова обробки даних високого рівня, який надає багатий набір типів даних та операторів для виконання різних операцій із даними.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Для виконання конкретного завдання програмістам, які використовують Pig, програмістам необхідно написати сценарій Pig з використанням мови Pig Latin і виконати їх з використанням будь-якого з механізмів виконання (Grunt Shell, UDFs, Embedded). Після виконання ці сценарії пройдуть серію перетворень, які застосовують Pig Framework, для отримання бажаного результату.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Внутрішньо Apache Pig перетворює ці сценарії на серію завдань MapReduce, що полегшує роботу програміста. Архітектура Apache Pig показана нижче.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:left"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 340.93px; height: 448.00px;"><img alt="Apache Pig Architecture" src="https://lh6.googleusercontent.com/Fkx14jDoTYloiPRXKhZ4eF07V7B7llJof9GXIlmuYrNJFYnmtRT446jLCT0LjYduLJNMNNWL4lVP9P335sf_J8ztN9dWNRIV1M7Kp1md6gy1ENGxoas8hCVkF7Nzi0k3HYwzdCmrnig0WLQEGFW95Q=s800" style="width: 340.93px; height: 448.00px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Apache Pig Компоненти</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Як показано на малюнку, у платформі Apache Pig є різні компоненти. Погляньмо на основні компоненти.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">синтаксичний аналізатор</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">оптимізатор</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">упорядник</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Двигун виконання</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Модель даних Pig Latin</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Модель даних Pig Latin повністю вкладена, і вона припускає складні неатомарні типи даних, такі як map і tuple. Нижче наведено схематичне представлення моделі даних Pig Latin.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:left"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 379.07px; height: 220.93px;"><img alt="Модель данных" src="https://lh6.googleusercontent.com/r7duYCHkIAXcm1r6gMx68JfZVGxks3x_wRFhJJStknK4ZulSnN08BEw9F6Nee4IPy2oa4uzhS9DePE-nUYKLkH2eNYeB0-CkZf4rReKYk5R0uvlZwYlh41uXozTJisqOrrS2nleRaKkSA8FLU1Kjvg=s800" style="width: 379.07px; height: 220.93px; margin-left: -0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">атом</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Будь-яке окреме значення в Pig Latin, незалежно від типу даних, називаєтьсяAtom. Він зберігається як рядок і може використовуватися як рядок та число. int, long, float, double, chararray та bytearray – це атомні значення Pig. Частина даних або проста атомарна величина називається полем.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000">Приклад - &quot;Раджа&quot; або &quot;30&quot;</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Кортеж</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Запис, який формується впорядкованим набором полів, називається кортежем, поля можуть бути будь-якого типу. Кортеж схожий рядок у таблиці RDBMS.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000">Приклад – (Раджа, 30)</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Мішок</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Сумка – це невпорядкований набір кортежів. Інакше кажучи, колекція кортежів (неунікальна) називається сумкою. Кожен кортеж може мати будь-яку кількість полів (гнучка схема). Сумка представлена як {{}. Вона схожа на таблицю в RDBMS, але на відміну від таблиці в RDBMS, необов&#39;язково, щоб кожен кортеж містив однакову кількість полів або поля в одній і тій же позиції (стовпці) мали однаковий тип.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000">Приклад - {(Раджа, 30), (Мухаммед, 45)}</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Сумка може бути полем у відношенні; у цьому контексті це відомо як внутрішня сумка.</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000">Приклад - {Raja, 30, {9848022338, raja@gmail.com ,}}</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">карта</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Карта (або карта даних) є набір пар ключ-значення. Ключ повинен бути типу char array і має бути унікальним. Значення може бути будь-якого типу. Він представлений як &#39;[]&#39;</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000">Приклад - [ім&#39;я Раджа, вік # 30]</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#2a2f35;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Зв&#39;язок</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;text-align:justify"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal">Відношення – це мішок кортежів. Відношення у Pig Latin невпорядковані (немає жодної гарантії, що кортежі будуть оброблені у будь-якому конкретному порядку).</span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:left"><span style="color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p><p style="padding:0;margin:0;color:#000000;font-weight:700;font-size:14pt;line-height:1.5;background-color:#ffffff;text-indent:35.5pt;font-family:&quot;Times New Roman&quot;;orphans:2;widows:2;height:14pt;text-align:justify"><span style="color:#111111;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:&quot;Times New Roman&quot;;font-style:normal"></span></p></div></div></div></div><script nonce="mq37_bhmd0cv-1tKTliK5A">window.setTimeout(function() { window.scrollTo(0, 1); }, 0)</script></body></html>